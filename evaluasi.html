<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zona Evaluasi Hidrokarbon</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Menambahkan Font Rajdhani untuk nuansa Sci-Fi -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&amp;family=Rajdhani:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    :root {
        --neon-cyan: #00f3ff;
        --neon-pink: #ff00ff;
        --neon-purple: #bc13fe;
        --bg-dark: #050510;
    }
    body {
      box-sizing: border-box;
      font-family: 'Rajdhani', sans-serif;
      background-color: var(--bg-dark);
      color: #e0e0e0;
    }
    * {
      font-family: 'Rajdhani', sans-serif;
    }
    h1, h2, h3, .font-display {
      font-family: 'Space Grotesk', sans-serif;
      letter-spacing: 0.05em;
    }
    
    /* Cyber Grid Background Effect */
    .cyber-grid {
        background-image: 
            linear-gradient(rgba(0, 243, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 243, 255, 0.03) 1px, transparent 1px);
        background-size: 40px 40px;
        position: fixed;
        inset: 0;
        z-index: 0;
        pointer-events: none;
        mask-image: radial-gradient(circle at center, black 30%, transparent 100%);
    }

    /* Glassmorphism Futuristik */
    .futuristic-card {
        background: rgba(12, 12, 30, 0.7);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(0, 243, 255, 0.2);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.5), inset 0 0 20px rgba(0, 243, 255, 0.02);
        position: relative;
        overflow: hidden;
    }
    
    /* Neon Glow Utilities */
    .text-glow-cyan { text-shadow: 0 0 10px rgba(0, 243, 255, 0.6); }
    .text-glow-purple { text-shadow: 0 0 10px rgba(188, 19, 254, 0.6); }
    .border-glow { box-shadow: 0 0 10px rgba(0, 243, 255, 0.3); }

    /* Custom Scrollbar */
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

    /* Animations */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    .float-animation { animation: float 4s ease-in-out infinite; }
    
    @keyframes pulse-neon {
      0%, 100% { opacity: 1; filter: drop-shadow(0 0 5px rgba(0,243,255,0.8)); }
      50% { opacity: 0.7; filter: drop-shadow(0 0 15px rgba(0,243,255,0.4)); }
    }
    .pulse-glow { animation: pulse-neon 2s infinite; }

    @keyframes bounce-in {
      0% { transform: scale(0.8); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    .bounce-in { animation: bounce-in 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); }

    /* Button Cyber Style */
    .btn-cyber {
        background: rgba(0, 243, 255, 0.1);
        border: 1px solid rgba(0, 243, 255, 0.4);
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    .btn-cyber:hover:not(:disabled) {
        background: rgba(0, 243, 255, 0.2);
        box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
        border-color: #00f3ff;
        transform: translateY(-2px);
    }
    .btn-cyber:disabled {
        opacity: 0.3;
        cursor: not-allowed;
        border-color: #555;
        background: transparent;
    }
    
    /* Checkbox Custom Style for Multi-select */
    .cyber-checkbox {
        width: 20px;
        height: 20px;
        border: 2px solid #555;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 12px;
        transition: all 0.2s;
    }
    .cyber-checkbox.checked {
        border-color: #00f3ff;
        background: rgba(0, 243, 255, 0.2);
        box-shadow: 0 0 8px rgba(0, 243, 255, 0.4);
    }
    .cyber-checkbox.checked::after {
        content: '‚úì';
        color: #00f3ff;
        font-weight: bold;
        font-size: 14px;
    }

    /* Confetti */
    .confetti {
        position: absolute;
        z-index: 999;
        pointer-events: none;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-slate-950 text-slate-200 overflow-hidden" onclick="initAudioContext()">
  
  <!-- Cyber Grid Background -->
  <div class="cyber-grid"></div>
  
  <!-- Ambient Lights -->
  <div class="fixed inset-0 pointer-events-none">
    <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-cyan-500/10 rounded-full blur-[120px]"></div>
    <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-purple-500/10 rounded-full blur-[120px]"></div>
  </div>

  <div id="app" class="h-full w-full flex flex-col overflow-auto scrollbar-hide relative z-10">
    
   <main class="flex-1 max-w-7xl mx-auto w-full px-4 md:px-6 py-4 md:py-8 relative z-10">
    <!-- Welcome Screen -->
    <div id="welcome-screen" class="h-full flex items-center justify-center relative min-h-[80vh]">
      
      <!-- Top Right Controls (Home & Help) -->
      <!-- Responsive positioning: closer to edges on mobile, slightly larger on desktop -->
      <div class="absolute top-2 right-2 md:top-6 md:right-6 z-50 flex items-center gap-2 md:gap-4">
        <!-- Help Button -->
        <button onclick="showInstructions()" class="w-12 h-12 md:w-14 md:h-14 rounded-xl flex items-center justify-center shadow-[0_0_15px_rgba(188,19,254,0.4)] hover:scale-110 transition-all duration-300 border border-purple-400/50 group relative overflow-hidden bg-black/60 backdrop-blur-md" title="Petunjuk Misi">
            <div class="absolute inset-0 bg-purple-500/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-purple-400 group-hover:text-white relative z-10 drop-shadow-[0_0_5px_rgba(188,19,254,0.8)]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg> 
        </button>

        <!-- Home Button (Link to Dashboard) -->
        <a href="dashboard.html" class="w-12 h-12 md:w-14 md:h-14 rounded-xl flex items-center justify-center shadow-[0_0_15px_rgba(0,243,255,0.4)] hover:scale-110 transition-all duration-300 border border-cyan-400/50 group relative overflow-hidden bg-black/60 backdrop-blur-md" title="Kembali ke Dashboard">
         <div class="absolute inset-0 bg-cyan-500/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
         <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 md:h-8 md:w-8 text-cyan-400 group-hover:text-white relative z-10 drop-shadow-[0_0_5px_rgba(0,243,255,0.8)]" viewBox="0 0 24 24" fill="currentColor">
           <path d="M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z" />
           <path d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z" />
         </svg> 
        </a>
      </div>

      <div class="text-center max-w-4xl bounce-in relative w-full pt-12 md:pt-8">
        
       <div class="text-6xl md:text-8xl mb-6 md:mb-8 float-animation drop-shadow-[0_0_20px_rgba(0,243,255,0.6)]">
        üìù
       </div>
       <h2 class="text-4xl md:text-6xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-cyan-400 via-white to-purple-400 mb-4 md:mb-6 font-display leading-tight tracking-wide uppercase text-glow-cyan">ZONA EVALUASI<br><span class="text-2xl md:text-4xl text-cyan-200">Pemahaman Hidrokarbon</span></h2>
       <div class="w-24 md:w-32 h-1 bg-gradient-to-r from-transparent via-cyan-500 to-transparent mx-auto mb-6 md:mb-8"></div>
       
       <p class="text-cyan-100/80 text-lg md:text-xl mb-8 md:mb-12 font-light tracking-wider px-4">Evaluasi pembelajaran dilakukan secara bertahap dari tingkat mudah hingga sulit.</p>
       
       <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 px-4">
        <!-- Level Easy -->
        <div class="futuristic-card rounded-xl p-6 md:p-8 hover:border-green-400/50 transition-all duration-300 hover:scale-105 cursor-pointer group relative" onclick="selectLevel('easy')">
         <div class="absolute inset-0 bg-green-500/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
         <div class="text-4xl md:text-5xl mb-4 group-hover:scale-110 transition-transform duration-300 drop-shadow-[0_0_10px_rgba(74,222,128,0.5)]">üå±</div>
         <div class="font-bold text-xl md:text-2xl text-white mb-2 font-display uppercase tracking-widest">Mudah</div>
         <div class="text-green-400 font-semibold mb-3 tracking-wide font-mono text-sm md:text-base">10 POIN / SOAL</div>
         <div class="text-slate-400 text-xs md:text-sm border-t border-white/10 pt-3">Pemahaman Konsep Dasar</div>
        </div>

        <!-- Level Medium -->
        <div id="medium-card" class="futuristic-card rounded-xl p-6 md:p-8 hover:border-amber-400/50 transition-all duration-300 border-white/5 relative overflow-hidden group cursor-pointer" onclick="selectLevel('medium')">
         <div class="absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-10 border border-amber-500/30" id="medium-lock">
          <div class="text-center">
           <div class="text-3xl md:text-4xl mb-2 text-amber-500 animate-pulse">üîí</div>
           <div class="text-white font-bold mb-1 uppercase tracking-widest text-sm md:text-base">TERKUNCI</div>
           <div class="text-slate-400 text-[10px] md:text-xs font-mono">REQ: >51 POIN (MUDAH)</div>
          </div>
         </div>
         <div class="absolute inset-0 bg-amber-500/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
         <div class="text-4xl md:text-5xl mb-4 transition-transform duration-300 drop-shadow-[0_0_10px_rgba(251,191,36,0.5)]">üî•</div>
         <div class="font-bold text-xl md:text-2xl text-white mb-2 font-display uppercase tracking-widest">Sedang</div>
         <div class="text-amber-400 font-semibold mb-3 tracking-wide font-mono text-sm md:text-base">10 POIN / SOAL</div>
         <div class="text-slate-400 text-xs md:text-sm border-t border-white/10 pt-3">Aplikasi Struktur &amp; Reaksi</div>
        </div>

        <!-- Level Hard -->
        <div id="hard-card" class="futuristic-card rounded-xl p-6 md:p-8 hover:border-purple-400/50 transition-all duration-300 border-white/5 relative overflow-hidden group cursor-pointer" onclick="selectLevel('hard')">
         <div class="absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-10 border border-purple-500/30" id="hard-lock">
          <div class="text-center">
           <div class="text-3xl md:text-4xl mb-2 text-purple-500 animate-pulse">üîí</div>
           <div class="text-white font-bold mb-1 uppercase tracking-widest text-sm md:text-base">TERKUNCI</div>
           <div class="text-slate-400 text-[10px] md:text-xs font-mono">REQ: >51 POIN (SEDANG)</div>
          </div>
         </div>
         <div class="absolute inset-0 bg-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity"></div>
         <div class="text-4xl md:text-5xl mb-4 transition-transform duration-300 drop-shadow-[0_0_10px_rgba(168,85,247,0.5)]">üíé</div>
         <div class="font-bold text-xl md:text-2xl text-white mb-2 font-display uppercase tracking-widest">Sulit</div>
         <div class="text-purple-400 font-semibold mb-3 tracking-wide font-mono text-sm md:text-base">10 POIN / SOAL</div>
         <div class="text-slate-400 text-xs md:text-sm border-t border-white/10 pt-3">Analisis HOTS &amp; SSI</div>
        </div>
       </div>
       
       <!-- Tombol Akses Riwayat (Futuristic Style) -->
       <div class="mt-8 md:mt-12">
         <button onclick="playSound('click'); showHistory()" class="w-full md:w-2/3 mx-auto bg-transparent border border-indigo-500/50 text-indigo-300 font-bold py-3 md:py-4 px-6 md:px-8 rounded-xl hover:bg-indigo-500/10 hover:border-indigo-400 hover:text-white hover:shadow-[0_0_20px_rgba(99,102,241,0.4)] transition-all duration-300 flex items-center justify-center gap-4 group"> 
             <span class="text-xl md:text-2xl group-hover:scale-125 transition-transform">üìö</span> 
             <span class="font-display text-base md:text-lg tracking-widest uppercase">Akses Database Riwayat</span> 
         </button>
       </div>
      </div>
    </div>
    
    <!-- Quiz Screen -->
    <div id="quiz-screen" class="hidden">
      <!-- Cyber Status Bar (Pengganti Tab Level) -->
      <div class="w-full mb-6 md:mb-8 relative overflow-hidden rounded-lg border border-white/10 bg-black/40 backdrop-blur-sm shadow-[0_0_15px_rgba(0,0,0,0.3)] group">
        <div class="absolute top-0 left-0 w-1 h-full bg-gradient-to-b from-cyan-400 to-purple-500"></div>
        <div class="absolute top-0 right-0 w-1 h-full bg-gradient-to-b from-purple-500 to-cyan-400 opacity-30"></div>
        
        <div class="flex justify-between items-center p-3 md:p-4 relative z-10">
            <!-- Left: System Status -->
            <div class="flex items-center gap-3 md:gap-4">
                <div class="relative">
                    <div class="w-8 h-8 md:w-10 md:h-10 rounded-full border border-cyan-500/30 flex items-center justify-center bg-cyan-500/5">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5 text-cyan-400 animate-pulse" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
                        </svg>
                    </div>
                    <div class="absolute -bottom-1 -right-1 w-2 h-2 md:w-3 md:h-3 bg-green-500 rounded-full border-2 border-black"></div>
                </div>
                <div class="flex flex-col">
                    <span class="text-[8px] md:text-[10px] text-cyan-500 font-mono tracking-[0.2em] uppercase">System Status</span>
                    <span class="text-white font-display text-xs md:text-base tracking-widest text-glow-cyan">
                        ONLINE_SECURE
                    </span>
                </div>
            </div>
            
            <!-- Center: Data Visualizer (Decorative) - Hidden on Mobile -->
            <div class="hidden md:flex items-end gap-1 h-8 opacity-70">
                <div class="w-1 bg-purple-500 rounded-t-sm animate-[bounce_1s_infinite]" style="animation-delay: 0.1s"></div>
                <div class="w-1 bg-cyan-500 rounded-t-sm animate-[bounce_1.2s_infinite]" style="animation-delay: 0.2s"></div>
                <div class="w-1 bg-purple-500 rounded-t-sm animate-[bounce_0.8s_infinite]" style="animation-delay: 0.3s"></div>
                <div class="w-1 bg-cyan-500 rounded-t-sm animate-[bounce_1.1s_infinite]" style="animation-delay: 0.4s"></div>
                <div class="w-1 bg-purple-500 rounded-t-sm animate-[bounce_0.9s_infinite]" style="animation-delay: 0.5s"></div>
                <div class="w-1 bg-cyan-500 rounded-t-sm animate-[bounce_1.3s_infinite]" style="animation-delay: 0.6s"></div>
            </div>

            <!-- Right: Protocol Info -->
            <div class="text-right">
                <span class="text-[8px] md:text-[10px] text-purple-400 font-mono tracking-[0.2em] uppercase">Protocol</span>
                <div class="text-slate-300 font-mono text-xs md:text-sm flex items-center justify-end gap-2">
                    <span class="w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-purple-500 animate-ping"></span>
                    <span>ACTIVE</span>
                </div>
            </div>
        </div>
        
        <!-- Background Grid Animation Overlay -->
        <div class="absolute inset-0 bg-[linear-gradient(90deg,transparent_0%,rgba(255,255,255,0.03)_50%,transparent_100%)] translate-x-[-100%] animate-[pulse_3s_ease-in-out_infinite]"></div>
      </div>
      
      <!-- Quiz Header (Futuristic) -->
      <div class="flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4 border-b border-white/10 pb-4">
       <div class="flex items-center gap-3 md:gap-4">
        <span id="level-emoji" class="text-3xl md:text-4xl drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]">üå±</span>
        <div>
         <h2 id="level-title" class="text-2xl md:text-3xl font-bold text-white font-display uppercase tracking-wider text-glow-cyan">Level Mudah</h2>
         <p id="level-desc" class="text-cyan-400 text-[10px] md:text-xs font-mono mt-1 tracking-widest uppercase">Mode: Pemahaman Konsep</p>
        </div>
       </div>
       
       <!-- Top Right Controls: Timer & Close -->
       <div class="flex items-center justify-between md:justify-end gap-4 w-full md:w-auto">
        <div id="timer-display" class="bg-black/50 border border-cyan-500/30 text-cyan-400 rounded-lg px-4 md:px-6 py-2 shadow-[0_0_10px_rgba(0,243,255,0.1)] font-mono text-xl md:text-2xl font-bold tracking-widest flex-1 md:flex-none text-center">
         20:00
        </div>
        <button onclick="confirmExit()" class="bg-red-900/20 hover:bg-red-600/20 text-red-500 hover:text-red-400 border border-red-500/30 hover:border-red-500 rounded-lg w-10 h-10 md:w-12 md:h-12 flex items-center justify-center transition-all duration-300 group" title="Abort Mission">
         <svg class="w-5 h-5 md:w-6 md:h-6 group-hover:rotate-90 transition-transform" fill="none" stroke="currentColor" viewbox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
         </svg> 
        </button>
       </div>
      </div>
      
      <!-- Linear Progress Bar -->
      <div class="w-full bg-slate-800/50 rounded-full h-1 mb-6 md:mb-8 overflow-hidden border border-white/5">
       <div id="quiz-progress-bar" class="h-full bg-gradient-to-r from-cyan-500 via-blue-500 to-purple-500 transition-all duration-500 shadow-[0_0_10px_#06b6d4]" style="width: 0%"></div>
      </div>
      
      <!-- MAIN QUIZ LAYOUT: Grid System -->
      <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 md:gap-8 mb-8">
       
       <!-- Left Column: Question Card & Controls (Span 3) -->
       <!-- Mobile Order: 1 (Content First), Desktop Order: 1 -->
       <div class="lg:col-span-3 order-1">
        <!-- Question Card -->
        <div class="futuristic-card rounded-2xl p-6 md:p-10 mb-6 md:mb-8 min-h-[300px] md:min-h-[400px]">
          <div class="flex items-start gap-4 mb-6 md:mb-8">
            <span class="bg-cyan-500/10 border border-cyan-500/30 text-cyan-300 text-[10px] md:text-xs font-bold px-3 py-1 md:px-4 md:py-1 rounded-sm uppercase tracking-widest" id="topic-badge"> SYSTEM_INIT </span>
          </div>
          <div id="image-container" class="mb-6 hidden"></div>
          <p id="question-text" class="text-lg md:text-2xl text-slate-100 leading-relaxed mb-8 md:mb-10 font-medium font-sans tracking-wide">Initializing data stream...</p>
          
          <!-- Options -->
          <div class="space-y-3 md:space-y-4" id="options-container">
            <!-- Options will be generated by JS -->
          </div>
        </div>

        <!-- Navigation Buttons (UPDATED LAYOUT) -->
        <div class="flex justify-between items-center gap-3 md:gap-4 flex-wrap">
          
          <!-- Tombol Sebelumnya -->
          <button onclick="prevQuestion()" id="prev-btn" class="flex-1 btn-cyber py-3 md:py-4 px-4 md:px-6 rounded-lg text-cyan-300 font-bold flex items-center justify-center gap-3 disabled:opacity-30 disabled:cursor-not-allowed text-sm md:text-base">
            <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            <span class="font-display inline">SEBELUMNYA</span>
          </button>
          
          <!-- Tombol Kirim (Hanya di Soal Terakhir) -->
          <button onclick="submitEarly()" id="submit-btn" class="hidden flex-1 bg-amber-500/10 border border-amber-500/50 text-amber-400 hover:bg-amber-500/20 hover:shadow-[0_0_15px_rgba(245,158,11,0.4)] transition-all font-bold py-3 md:py-4 px-4 md:px-6 rounded-lg flex items-center justify-center gap-2 text-sm md:text-base"> 
            <span class="text-lg md:text-xl">üì§</span> 
            <span class="font-display tracking-widest">KIRIM</span> 
          </button>
          
          <!-- Tombol Selanjutnya -->
          <button onclick="nextQuestion()" id="next-btn" class="flex-1 btn-cyber py-3 md:py-4 px-4 md:px-6 rounded-lg text-cyan-300 font-bold flex items-center justify-center gap-3 disabled:opacity-30 disabled:cursor-not-allowed text-sm md:text-base"> 
            <span class="font-display inline">SELANJUTNYA</span>
            <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </button>

        </div>
       </div>

       <!-- Right Column: Navigation Pills Sidebar (Span 1) -->
       <!-- Mobile Order: 2 (Bottom), Desktop Order: 2 -->
       <div class="lg:col-span-1 order-2">
        <div class="futuristic-card rounded-xl p-4 md:p-6 lg:sticky lg:top-24">
          <h3 class="text-white font-bold font-display mb-4 flex items-center gap-2 uppercase tracking-wider text-xs md:text-sm border-b border-white/10 pb-2">
            <span class="text-cyan-400">‚ùñ</span> Peta Navigasi
          </h3>
          <div class="grid grid-cols-5 gap-2 md:gap-3" id="question-pills">
            <!-- Pills will be generated by JS -->
          </div>
          <div class="mt-4 md:mt-6 space-y-2 md:space-y-3 text-[10px] md:text-xs text-slate-400 border-t border-white/10 pt-4 font-mono">
             <div class="flex items-center gap-3">
               <div class="w-3 h-3 rounded-sm bg-gradient-to-r from-cyan-500 to-blue-500 shadow-[0_0_5px_#06b6d4]"></div>
               <span>TERJAWAB</span>
             </div>
             <div class="flex items-center gap-3">
               <div class="w-3 h-3 rounded-sm border border-slate-600 bg-slate-800"></div>
               <span>KOSONG</span>
             </div>
             <div class="flex items-center gap-3">
               <div class="w-3 h-3 rounded-sm border border-purple-500 bg-purple-500/20 shadow-[0_0_5px_#a855f7]"></div>
               <span>AKTIF</span>
             </div>
          </div>
        </div>
       </div>

      </div>
    </div>
    
    <!-- Result Screen -->
    <div id="result-screen" class="hidden h-full flex items-center justify-center">
    </div>
    
    <!-- Review Screen -->
    <div id="review-screen" class="hidden">
    </div>

    <!-- History Screen -->
    <div id="history-screen" class="hidden">
      <div class="flex items-center justify-between mb-6 md:mb-8 pb-4 border-b border-white/10">
       <h2 class="text-2xl md:text-4xl font-bold text-white font-display text-glow-cyan uppercase tracking-wider">DATABASE RIWAYAT</h2>
       <button onclick="backToHome()" class="btn-cyber py-2 px-4 md:py-3 md:px-6 rounded-lg text-cyan-300 font-bold flex items-center gap-2 text-sm md:text-base"> 
         <span>‚Üê</span> <span class="hidden md:inline">KEMBALI</span>
       </button>
      </div>
      
      <!-- Level Tabs -->
      <div class="flex gap-2 md:gap-4 mb-6 md:mb-8 flex-wrap">
         <button onclick="showHistoryLevel('easy')" id="history-tab-easy" class="flex-1 py-2 md:py-3 px-2 md:px-4 rounded-lg font-bold transition-all duration-300 bg-black/40 border border-slate-700 text-slate-400 uppercase tracking-widest hover:text-green-400 text-xs md:text-sm"> 
             üå± Mudah 
         </button> 
         <button onclick="showHistoryLevel('medium')" id="history-tab-medium" class="flex-1 py-2 md:py-3 px-2 md:px-4 rounded-lg font-bold transition-all duration-300 bg-black/40 border border-slate-700 text-slate-400 uppercase tracking-widest hover:text-amber-400 text-xs md:text-sm"> 
             üî• Sedang 
         </button> 
         <button onclick="showHistoryLevel('hard')" id="history-tab-hard" class="flex-1 py-2 md:py-3 px-2 md:px-4 rounded-lg font-bold transition-all duration-300 bg-black/40 border border-slate-700 text-slate-400 uppercase tracking-widest hover:text-purple-400 text-xs md:text-sm"> 
             üíé Sulit 
         </button>
      </div>
      
      <!-- Level Summary Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-8" id="level-stats-container">
         <div class="futuristic-card rounded-xl p-4 md:p-6 border-t-4 border-t-green-500">
             <div class="text-[10px] md:text-xs text-green-400 font-mono mb-1">LEVEL 01</div>
             <h3 class="text-white font-bold font-display text-lg md:text-xl uppercase mb-2">Mudah</h3>
             <div class="text-2xl md:text-3xl font-bold text-white mb-1 font-mono" id="history-easy-score">-</div>
             <div class="text-slate-400 text-[10px] md:text-xs" id="history-easy-status">No Data</div>
         </div>
         <div class="futuristic-card rounded-xl p-4 md:p-6 border-t-4 border-t-amber-500">
             <div class="text-[10px] md:text-xs text-amber-400 font-mono mb-1">LEVEL 02</div>
             <h3 class="text-white font-bold font-display text-lg md:text-xl uppercase mb-2">Sedang</h3>
             <div class="text-2xl md:text-3xl font-bold text-white mb-1 font-mono" id="history-medium-score">-</div>
             <div class="text-slate-400 text-[10px] md:text-xs" id="history-medium-status">No Data</div>
         </div>
         <div class="futuristic-card rounded-xl p-4 md:p-6 border-t-4 border-t-purple-500">
             <div class="text-[10px] md:text-xs text-purple-400 font-mono mb-1">LEVEL 03</div>
             <h3 class="text-white font-bold font-display text-lg md:text-xl uppercase mb-2">Sulit</h3>
             <div class="text-2xl md:text-3xl font-bold text-white mb-1 font-mono" id="history-hard-score">-</div>
             <div class="text-slate-400 text-[10px] md:text-xs" id="history-hard-status">No Data</div>
         </div>
      </div>
      
      <div id="history-content" class="space-y-4 md:space-y-6 min-h-[300px] md:min-h-[400px]">
        <!-- History items will be generated by JS -->
      </div>
    </div>
   </main>
  </div>

  <script>
    // --- WEB AUDIO API SYSTEM (NO EXTERNAL FILES) ---
    // Menggunakan AudioContext bawaan browser untuk menghasilkan suara
    // Ini menghindari masalah CORS/Network Error dari file eksternal
    
    // Inisialisasi context (akan di-resume saat interaksi user)
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    let audioCtx;

    function initAudioContext() {
        if (!audioCtx) {
            audioCtx = new AudioContext();
        }
        if (audioCtx.state === 'suspended') {
            audioCtx.resume();
        }
    }

    const SoundSystem = {
        // Fungsi dasar penghasil nada (Synthesizer)
        playTone: (freq, type, duration, delay = 0, volume = 0.1) => {
            if (!audioCtx) initAudioContext();
            
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            
            osc.type = type; // sine, square, sawtooth, triangle
            osc.frequency.value = freq;
            
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            const now = audioCtx.currentTime + delay;
            
            osc.start(now);
            gain.gain.setValueAtTime(volume, now);
            gain.gain.exponentialRampToValueAtTime(0.001, now + duration);
            osc.stop(now + duration);
        },
        
        // --- PRESET SUARA ---
        click: () => {
            // Suara "Blip" Sci-Fi (High pitch sine)
            SoundSystem.playTone(1200, 'sine', 0.1, 0, 0.05);
        },
        
        warning: () => {
            // Suara "Error/Deny" (Low pitch sawtooth pattern)
            SoundSystem.playTone(150, 'sawtooth', 0.15, 0, 0.1);
            SoundSystem.playTone(100, 'sawtooth', 0.3, 0.1, 0.1);
        },
        
        success: () => {
            // Suara "Benar/Sukses" (Chord naik)
            SoundSystem.playTone(523.25, 'sine', 0.2, 0, 0.1); // C5
            SoundSystem.playTone(659.25, 'sine', 0.4, 0.1, 0.1); // E5
        },
        
        win: () => {
            // Suara "Menang/Selesai" (Fanfare sederhana)
            const now = audioCtx ? audioCtx.currentTime : 0;
            [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                SoundSystem.playTone(freq, 'square', 0.3, i * 0.1, 0.05);
            });
        }
    };

    function playSound(type) {
        // Coba init context jika belum
        initAudioContext();
        
        if (SoundSystem[type]) {
            SoundSystem[type]();
        }
    }

    // Questions Database
    const questions = {
      easy: [
        {
          topic: "Kekhasan Atom Karbon",
          question: "Atom karbon memiliki kekhasan yang tidak dimiliki atom lain sehingga mampu membentuk jutaan senyawa. Kekhasan tersebut adalah...",
          options: ["A. Memiliki nomor atom 12", "B. Mampu membentuk 4 ikatan kovalen yang kuat", "C. Bersifat logam yang reaktif", "D. Hanya dapat membentuk ikatan tunggal", "E. Memiliki 6 elektron valensi"],
          answer: 1,
          type: "single",
          explanation: `Jawaban yang tepat adalah B (Mampu membentuk 4 ikatan kovalen yang kuat).<br><br>
          Mari kita analisis satu per satu:<br>
          <ul class="list-disc list-inside mt-2 text-slate-300">
            <li><strong>Konfigurasi Elektron:</strong> Atom Karbon (nomor atom 6) memiliki konfigurasi elektron 2.4. Ini berarti ada 4 elektron di kulit terluar (elektron valensi).</li>
            <li><strong>Kestabilan (Kaidah Oktet):</strong> Agar stabil seperti gas mulia (8 elektron valensi), karbon perlu berbagi 4 elektron dengan atom lain.</li>
            <li><strong>Ikatan Kovalen:</strong> Karbon membentuk 4 "tangan" atau ikatan kovalen yang kuat. Kemampuan ini memungkinkannya membentuk rantai panjang, bercabang, hingga melingkar.</li>
          </ul><br>
          <strong>Mengapa opsi lain salah?</strong><br>
          A. Nomor atom karbon adalah 6, bukan 12 (12 adalah nomor massa rata-rata).<br>
          C. Karbon adalah non-logam.<br>
          D. Karbon bisa membentuk ikatan rangkap dua (=) dan tiga (‚â°).<br>
          E. Elektron valensinya 4, bukan 6.`
        },
        {
          topic: "Alkuna & Aplikasi",
          question: "Pedagang buah sering menggunakan gas tertentu untuk mempercepat pematangan pisang secara paksa. Gas tersebut termasuk golongan alkuna dengan rumus kimia...",
          options: ["A. CH‚ÇÑ (Metana)", "B. C‚ÇÇH‚ÇÑ (Etena)", "C. C‚ÇÇH‚ÇÇ (Etuna/Karbit)", "D. C‚ÇÉH‚Çà (Propana)", "E. CO‚ÇÇ (Karbon Dioksida)"],
          answer: 2,
          type: "single",
          explanation: `Jawaban yang tepat adalah C (C‚ÇÇH‚ÇÇ - Etuna/Karbit).<br><br>
          <strong>Analisis Detail:</strong><br>
          Gas yang dimaksud adalah <strong>Gas Asetilena</strong> atau nama kimianya <strong>Etuna</strong>. Gas ini dihasilkan dari reaksi karbit (Kalsium Karbida) dengan air:<br>
          <code class="block bg-black/30 p-2 rounded mt-1 mb-2 text-cyan-300">CaC‚ÇÇ + 2H‚ÇÇO ‚Üí C‚ÇÇH‚ÇÇ + Ca(OH)‚ÇÇ + Kalor</code>
          Reaksi ini menghasilkan panas (eksoterm) yang memicu pematangan buah secara paksa.<br><br>
          <strong>Definisi Senyawa Lain:</strong><br>
          <ul class="list-disc list-inside text-slate-300">
            <li><strong>Metana (CH‚ÇÑ):</strong> Komponen utama gas alam/biogas.</li>
            <li><strong>Etena (C‚ÇÇH‚ÇÑ):</strong> Hormon tumbuhan alami untuk pematangan (bukan dari karbit).</li>
            <li><strong>Propana (C‚ÇÉH‚Çà):</strong> Bahan bakar LPG.</li>
          </ul>`
        },
        {
          topic: "Kekhasan Atom Karbon",
          question: "Kemampuan atom karbon untuk membentuk rantai karbon yang panjang dan bercabang disebut...",
          options: ["A. Isomerisasi", "B. Katenasi", "C. Polimerisasi", "D. Kondensasi", "E. Substitusi"],
          answer: 1,
          type: "single",
          explanation: `Jawaban yang tepat adalah B (Katenasi).<br><br>
          Istilah ini berasal dari bahasa Latin <em>catena</em> yang berarti 'rantai'.<br>
          <strong>Mengapa bisa terjadi?</strong><br>
          Karena jari-jari atom karbon relatif kecil, ikatan antar atom karbon (C-C) sangat kuat dan stabil. Hal ini memungkinkan pembentukan rantai yang sangat panjang, baik lurus, bercabang, maupun melingkar (siklik).<br><br>
          <strong>Definisi Istilah Lain:</strong><br>
          <ul class="list-disc list-inside text-slate-300">
            <li><strong>Isomerisasi:</strong> Perubahan struktur molekul tanpa mengubah rumus kimianya.</li>
            <li><strong>Polimerisasi:</strong> Penggabungan molekul kecil (monomer) menjadi molekul raksasa (polimer).</li>
            <li><strong>Substitusi:</strong> Reaksi penggantian satu gugus atom dengan gugus lain.</li>
          </ul>`
        },
        {
          topic: "Senyawa Karbon",
          question: "Bahan padat berwarna abu-abu yang dimasukkan ke dalam tabung lampu karbit adalah...",
          options: ["A. Kalsium Karbonat (CaCO‚ÇÉ)", "B. Kalsium Karbida (CaC‚ÇÇ)", "C. Karbon Murni (C)", "D. Kalium Klorida (KCl)", "E. Kalsium Hidroksida (Ca(OH)‚ÇÇ)"],
          answer: 1,
          type: "single",
          explanation: `Jawaban yang tepat adalah B (Kalsium Karbida - CaC‚ÇÇ).<br><br>
          Bahan padat berwarna abu-abu kehitaman ini dikenal di pasaran sebagai "Karbit".<br>
          <strong>Fungsi:</strong><br>
          Digunakan sebagai sumber gas asetilena untuk pengelasan atau lampu karbit jaman dahulu. CaC‚ÇÇ tidak terdapat bebas di alam, melainkan diproduksi dengan memanaskan kapur (CaO) dan kokas (C) pada suhu sangat tinggi.<br><br>
          <strong>Senyawa Lain:</strong><br>
          A. CaCO‚ÇÉ = Batu kapur / Marmer.<br>
          E. Ca(OH)‚ÇÇ = Air kapur (hasil samping reaksi karbit).`
        },
        {
          topic: "Hidrokarbon dalam Kehidupan",
          question: "Kompor gas di rumah kita umumnya menggunakan LPG yang berisi Propana (C‚ÇÉH‚Çà) dan Butana (C‚ÇÑH‚ÇÅ‚ÇÄ). Pada suhu kamar, wujud kedua senyawa ini adalah...",
          options: ["A. Cair", "B. Padat", "C. Gas", "D. Plasma", "E. Larutan"],
          answer: 2,
          type: "single",
          explanation: `Jawaban yang tepat adalah C (Gas).<br><br>
          <strong>Penjelasan Fisika & Kimia:</strong><br>
          Alkana dengan jumlah atom karbon 1 sampai 4 (C1-C4) berwujud <strong>GAS</strong> pada suhu kamar dan tekanan standar (1 atm).<br>
          - Propana (C3) dan Butana (C4) adalah gas.<br>
          - LPG singkatan dari <em>Liquefied Petroleum Gas</em> (Gas Minyak Bumi yang Dicairkan).<br>
          <strong>Kenapa di dalam tabung terasa kocak seperti air?</strong><br>
          Gas tersebut dimasukkan ke dalam tabung dengan <strong>tekanan tinggi</strong> sehingga partikelnya merapat dan berubah fase menjadi cair. Begitu keluar dari tabung menuju kompor, tekanannya turun dan kembali menjadi gas.`
        },
        {
          topic: "Klasifikasi Hidrokarbon",
          question: "Manakah di antara senyawa berikut yang tergolong Alkuna?",
          options: ["A. C‚ÇÉH‚Çà", "B. C‚ÇÑH‚ÇÅ‚ÇÄ", "C. C‚ÇÖH‚ÇÅ‚ÇÄ", "D. C‚ÇÑH‚ÇÜ", "E. C‚ÇÇH‚ÇÜ"],
          answer: 3,
          type: "single",
          explanation: `Jawaban yang tepat adalah D (C‚ÇÑH‚ÇÜ).<br><br>
          Mari kita cek menggunakan <strong>Rumus Umum</strong>:<br>
          <ul class="list-disc list-inside text-slate-300">
            <li><strong>Alkana (Jenuh):</strong> C‚ÇôH‚ÇÇ‚Çô‚Çä‚ÇÇ</li>
            <li><strong>Alkena (Rangkap 2):</strong> C‚ÇôH‚ÇÇ‚Çô</li>
            <li><strong>Alkuna (Rangkap 3):</strong> C‚ÇôH‚ÇÇ‚Çô‚Çã‚ÇÇ</li>
          </ul><br>
          <strong>Analisis Opsi:</strong><br>
          A. C‚ÇÉH‚Çà ‚Üí H = 2(3)+2 = 8. (Alkana)<br>
          B. C‚ÇÑH‚ÇÅ‚ÇÄ ‚Üí H = 2(4)+2 = 10. (Alkana)<br>
          C. C‚ÇÖH‚ÇÅ‚ÇÄ ‚Üí H = 2(5) = 10. (Alkena)<br>
          D. <strong>C‚ÇÑH‚ÇÜ</strong> ‚Üí H = 2(4)-2 = 6. Sesuai rumus Alkuna!<br>
          E. C‚ÇÇH‚ÇÜ ‚Üí H = 2(2)+2 = 6. (Alkana)`
        },
        {
          topic: "Reaksi Hidrokarbon",
          question: "Reaksi kimia pada alkena biasanya terjadi pada bagian...",
          options: ["A. Ikatan tunggal C-H", "B. Ikatan rangkap dua C=C", "C. Rantai karbon ujung", "D. Cabang metil", "E. Inti atom"],
          answer: 1,
          type: "single",
          explanation: `Jawaban yang tepat adalah B (Ikatan rangkap dua C=C).<br><br>
          <strong>Konsep Gugus Fungsi:</strong><br>
          Ikatan rangkap dua (C=C) adalah pusat reaktivitas pada alkena. Ikatan ini terdiri dari satu ikatan sigma (kuat) dan satu ikatan pi (lemah).<br>
          Karena ikatan pi mudah putus, pereaksi lain dapat masuk dan menyerang bagian ini. Reaksi pemutusan ikatan rangkap menjadi ikatan tunggal disebut reaksi <strong>Adisi</strong>.`
        },
        {
          topic: "Jenis Atom Karbon",
          question: "Jumlah atom karbon primer, sekunder, tersier, dan kuartener yang terkandung pada senyawa berikut ini secara berturut-turut adalah...",
          image: "https://github.com/auliaputriindah06-crypto/mpihidrokarbon/blob/main/Screenshot%202026-01-24%20141458.png?raw=true",
          options: ["A. 5,5,3,1", "B. 4,5,2,1", "C. 5,5,1,1", "D. 5,5,1,2", "E. 5,4,1,1"],
          answer: 2, // Index 2 adalah C
          type: "single",
          explanation: `Jawaban yang tepat adalah C (5, 5, 1, 1).<br><br>
          Mari kita hitung satu per satu dari struktur pada gambar:<br>
          <ul class="list-disc list-inside mt-2 text-slate-300">
            <li><strong>Primer (1¬∞):</strong> Atom C yang mengikat 1 atom C lain (biasanya gugus -CH‚ÇÉ di ujung). Ada <strong>5</strong> buah.</li>
            <li><strong>Sekunder (2¬∞):</strong> Atom C yang mengikat 2 atom C lain (gugus -CH‚ÇÇ- di tengah rantai). Ada <strong>5</strong> buah.</li>
            <li><strong>Tersier (3¬∞):</strong> Atom C yang mengikat 3 atom C lain (gugus >CH- di percabangan). Ada <strong>1</strong> buah.</li>
            <li><strong>Kuartener (4¬∞):</strong> Atom C yang mengikat 4 atom C lain (C tanpa hidrogen). Ada <strong>1</strong> buah.</li>
          </ul>
          Jadi urutannya adalah <strong>5, 5, 1, 1</strong>.`
        },
        {
          topic: "Sifat Senyawa Organik",
          question: "Pernyataan berikut ini yang bukan sifat dari senyawa organik adalah...",
          options: ["A. Titik didih dan titik leleh rendah", "B. Tidak tahan terhadap pemanasan", "C. Umumnya tidak larut dalam air", "D. Reaksi antarmolekul berlangsung cepat", "E. Berikatan kovalen"],
          answer: 3,
          type: "single",
          explanation: `Jawaban yang tepat adalah D (Reaksi antarmolekul berlangsung cepat).<br><br>
          <strong>Mengapa ini BUKAN sifat senyawa organik?</strong><br>
          Senyawa organik umumnya memiliki ikatan kovalen yang stabil. Untuk bereaksi, ikatan-ikatan kovalen lama harus diputus terlebih dahulu sebelum membentuk ikatan baru. Proses ini membutuhkan energi aktivasi yang tinggi, sehingga reaksi organik cenderung berjalan <strong>lambat</strong>.<br><br>
          Sebaliknya, reaksi yang berlangsung sangat cepat (seketika) adalah ciri khas reaksi senyawa ionik (anorganik), seperti pengendapan garam.`
        },
        {
          topic: "Konsep Isomer",
          question: "Dua senyawa berbeda yang memiliki rumus molekul sama disebut...",
          options: ["A. Isotop", "B. Isobar", "C. Isomer", "D. Polimer", "E. Monomer"],
          answer: 2,
          type: "single",
          explanation: `Jawaban yang tepat adalah C (Isomer).<br><br>
          <strong>Definisi Detail:</strong><br>
          Isomer berasal dari kata Yunani <em>iso</em> (sama) dan <em>meros</em> (bagian). Artinya senyawa-senyawa yang memiliki bagian/komposisi atom yang sama (rumus molekul sama), tetapi penyusunan strukturnya berbeda.<br>
          Contoh: Butana (rantai lurus) dan Isobutana (bercabang) sama-sama C‚ÇÑH‚ÇÅ‚ÇÄ.<br><br>
          <strong>Istilah Lain:</strong><br>
          A. Isotop: Atom sejenis beda massa (Proton sama, Neutron beda).<br>
          B. Isobar: Atom beda jenis, massa sama.<br>
          D. Polimer: Molekul raksasa rantai panjang.`
        }
      ],
      medium: [
        {
          topic: "Tata Nama Alkana",
          question: "Nama IUPAC yang tepat untuk struktur: <span class=\"text-cyan-300 font-mono font-bold tracking-wider\">CH‚ÇÉ‚àíCH(CH‚ÇÉ)‚àíCH‚ÇÇ-CH(C‚ÇÇH‚ÇÖ)‚àíCH‚ÇÉ</span> adalah...",
          options: ["A. 3-metilheksena", "B. 4-etil-2-metilpentana", "C. 2-etil-4-metilpentana", "D. 2,4-dimetilheksana", "E. 3,5-dimetilheksana"],
          answer: 3,
          type: "single",
          explanation: `Jawaban yang tepat adalah D (2,4-dimetilheksana).<br><br>
          <img src="https://github.com/auliaputriindah06-crypto/mpihidrokarbon/blob/main/Screenshot%202026-01-24%20174043.png?raw=true" class="w-full max-w-sm mx-auto rounded-lg border border-cyan-500/30 my-4 shadow-[0_0_15px_rgba(0,243,255,0.2)]" alt="Ilustrasi Rantai Induk"><br>
          <strong>Langkah Penyelesaian:</strong><br>
          1. <strong>Tentukan Rantai Induk:</strong> Cari rantai karbon terpanjang yang bersambung. Jangan terkecoh dengan garis lurus! Jika kita belok ke atas pada gugus etil (C‚ÇÇH‚ÇÖ), kita mendapatkan rantai 6 karbon (Heksana). Rantai lurus hanya 5 karbon (Pentana).<br>
          2. <strong>Penomoran:</strong> Nomor dimulai dari ujung yang paling dekat dengan cabang pertama.<br>
             - Dari kiri: Cabang metil di nomor 2.<br>
             - Dari kanan (bawah): Cabang metil di nomor 3.<br>
             Maka, penomoran dimulai dari Kiri.<br>
          3. <strong>Nama Cabang:</strong> Ada metil di C-2 dan metil di C-4 (karena gugus etil tadi menjadi bagian rantai utama, menyisakan 1 C sebagai cabang).<br>
          Jadi namanya: <strong>2,4-dimetilheksana</strong>.`
        },
        {
          topic: "Reaksi Hidrokarbon",
          question: "Pembuatan margarin padat dari minyak cair dilakukan dengan mereaksikan minyak dengan gas Hidrogen. Reaksi pengubahan ikatan rangkap menjadi tunggal ini disebut...",
          options: ["A. Eliminasi", "B. Substitusi", "C. Adisi", "D. Oksidasi", "E. Polimerisasi"],
          answer: 2,
          type: "single",
          explanation: `Jawaban yang tepat adalah C (Adisi).<br><br>
          <strong>Konsep Reaksi:</strong><br>
          Minyak goreng cair mengandung banyak asam lemak tak jenuh (ikatan rangkap C=C). Untuk memadatkannya menjadi margarin, ikatan rangkap ini harus diputus ("dijenuhkan").<br>
          Proses penambahan atom (dalam hal ini Hidrogen) pada ikatan rangkap sehingga berubah menjadi ikatan tunggal disebut reaksi <strong>Adisi</strong> (Penambahan).<br><br>
          <strong>Kebalikan:</strong><br>
          Reaksi Eliminasi adalah kebalikannya, yaitu membuang atom untuk membentuk ikatan rangkap.`
        },
        {
          topic: "Sifat Fisik Alkana",
          question: "Manakah senyawa berikut yang memiliki titik didih paling tinggi?",
          options: ["A. Etana (C‚ÇÇH‚ÇÜ)", "B. Butana (C‚ÇÑH‚ÇÅ‚ÇÄ)", "C. Heksana (C‚ÇÜH‚ÇÅ‚ÇÑ)", "D. Oktana (C‚ÇàH‚ÇÅ‚Çà)", "E. Propana (C‚ÇÉH‚Çà)"],
          answer: 3,
          type: "single",
          explanation: `Jawaban yang tepat adalah D (Oktana - C‚ÇàH‚ÇÅ‚Çà).<br><br>
          <strong>Prinsip Fisika Kimia:</strong><br>
          Titik didih senyawa hidrokarbon bergantung pada kekuatan gaya tarik antarmolekul (Gaya London/Van der Waals).<br>
          Kekuatan gaya ini berbanding lurus dengan <strong>Massa Molekul Relatif (Mr)</strong> atau panjang rantai karbon.<br><br>
          Semakin panjang rantai karbon ‚Üí Semakin besar bidang sentuh antar molekul ‚Üí Gaya tarik makin kuat ‚Üí Butuh energi (panas) lebih banyak untuk mendidih.<br>
          Urutan panjang rantai: Etana(2) < Propana(3) < Butana(4) < Heksana(6) < <strong>Oktana(8)</strong>.`
        },
        {
          topic: "Aplikasi Alkuna",
          question: "Mengapa gas Asetilena (C‚ÇÇH‚ÇÇ) dipilih untuk mengelas dan memotong besi, bukan gas Metana?",
          options: ["A. Karena Asetilena lebih murah.", "B. Karena pembakaran Asetilena menghasilkan suhu ekstrem.", "C. Karena Asetilena tidak berbau.", "D. Karena Asetilena membuat besi jadi lunak tanpa panas.", "E. Karena Asetilena gas yang paling ringan."],
          answer: 1,
          type: "single",
          explanation: `Jawaban yang tepat adalah B (Menghasilkan suhu ekstrem).<br><br>
          <strong>Penjelasan:</strong><br>
          Ikatan rangkap tiga (‚â°) pada asetilena menyimpan energi yang sangat besar. Ketika dibakar dengan suplai oksigen murni (Oxy-Acetylene), pemutusan ikatan ini melepaskan kalor yang luar biasa besar (Sangat Eksoterm).<br>
          Nyala api yang dihasilkan bisa mencapai suhu <strong>3.000¬∞C - 3.500¬∞C</strong>. Suhu setinggi ini mampu melelehkan besi dan baja dengan cepat untuk proses pengelasan atau pemotongan.`
        },
        {
          topic: "Keselamatan Gas",
          question: "Gas LPG aslinya tidak berbau. Pertamina menambahkan zat Mercaptan yang baunya menyengat dengan tujuan...",
          options: ["A. Menambah panas api.", "B. Mencegah pembekuan gas.", "C. Sebagai indikator keselamatan agar kebocoran gas segera terdeteksi.", "D. Mengawetkan tabung gas.", "E. Membunuh bakteri."],
          answer: 2,
          type: "single",
          explanation: `Jawaban yang tepat adalah C (Indikator keselamatan).<br><br>
          <strong>Fakta Keselamatan:</strong><br>
          Gas hidrokarbon murni seperti Propana dan Butana (isi LPG) itu <strong>tidak berbau</strong> dan tidak berwarna. Jika terjadi kebocoran di dapur tertutup, penghuni tidak akan menyadarinya sampai terlambat (terjadi ledakan/kebakaran).<br>
          Zat <strong>Etil Merkaptan (C‚ÇÇH‚ÇÖSH)</strong> yang berbau seperti durian busuk/telur busuk sengaja ditambahkan dalam jumlah sangat kecil sebagai alarm penciuman agar kita segera sadar jika ada gas yang bocor.`
        },
        {
          topic: "Analisis Struktur Alkena",
          question: "Tata nama IUPAC penting untuk mengenali struktur senyawa hidrokarbon. Perhatikan struktur senyawa berikut: <span class=\"text-cyan-300 font-mono font-bold tracking-wider\">CH‚ÇÉ-CH‚ÇÇ-CH=CH-CH‚ÇÉ</span>. Pilihlah pernyataan yang benar mengenai penamaan senyawa tersebut!",
          options: ["A. Merupakan senyawa alkena", "B. Memiliki 5 atom karbon", "C. Gugus alkena berada pada posisi karbon ke-3", "D. Tata nama IUPAC-nya adalah 2-pentena", "E. Senyawa ini jenuh"],
          answer: [0, 1, 3], // Indices for checkboxes
          type: "multiple",
          explanation: `Jawaban Benar: A, B, D.<br><br>
          <strong>Analisis Struktur (CH‚ÇÉ-CH‚ÇÇ-CH=CH-CH‚ÇÉ):</strong><br>
          1. Ada ikatan rangkap dua (=), maka golongan <strong>Alkena</strong>. (A Benar, E Salah karena alkena itu tak jenuh).<br>
          2. Hitung jumlah atom C: 1 + 1 + 1 + 1 + 1 = <strong>5 atom Karbon</strong>. (B Benar).<br>
          3. <strong>Penomoran:</strong> Harus dimulai dari ujung kanan agar ikatan rangkap mendapat nomor terkecil.
             - Dari kanan: Rangkap di nomor 2.
             - Dari kiri: Rangkap di nomor 3.
             Maka posisi alkena di nomor 2 (C Salah).<br>
          4. Nama IUPAC: 5 karbon (pentena) + posisi 2 = <strong>2-pentena</strong>. (D Benar).`
        },
        {
          topic: "Bentuk Rantai Karbon",
          question: "Rantai karbon dalam senyawa hidrokarbon dapat berbentuk lurus, bercabang, atau cincin. Manakah pernyataan berikut yang menggambarkan bentuk rantai karbon secara tepat?",
          options: ["A. Rantai lurus hanya terdiri dari atom C primer", "B. Rantai bercabang memiliki atom karbon yang terhubung ke tiga atau lebih atom C lainnya", "C. Senyawa siklik memiliki struktur tertutup", "D. Sikloalkana adalah contoh rantai karbon lurus", "E. Isomer rantai dapat berbeda sifat fisiknya"],
          answer: [1, 2, 4], // Indices for checkboxes
          type: "multiple",
          explanation: `Jawaban Benar: B, C, E.<br><br>
          <strong>Analisis Pilihan:</strong><br>
          A. Salah. Rantai lurus pasti memiliki atom C sekunder (-CH‚ÇÇ-) di tengahnya, bukan hanya primer.<br>
          B. <strong>Benar.</strong> Cabang terbentuk jika ada atom C tersier (mengikat 3 C) atau kuartener (mengikat 4 C).<br>
          C. <strong>Benar.</strong> Siklik (dari kata <em>circle</em>) artinya rantai tertutup/melingkar.<br>
          D. Salah. Sikloalkana adalah contoh rantai tertutup/siklik, bukan lurus.<br>
          E. <strong>Benar.</strong> Isomer rantai (misal: n-butana lurus vs isobutana bulat) memiliki luas permukaan sentuh beda, sehingga titik didihnya berbeda.`
        },
        {
          topic: "Isomer Geometri",
          question: "Perhatikan gambar struktur (2-butena). Tentukan pernyataan yang sesuai berdasarkan struktur senyawa tersebut!",
          image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgQicPDxSC-a1hErRvxkyZT9TrM7LY7YqdynZvrWknnHVlCeKtwzjBka2blYjVPBNmuTE7zG6EUB55XwskNhDCLZRbcJ7f7SNjLg8eevoSlVd-4jW2ck0HkcA_RpRxn1rodL6W0flYP5eUWpS8t7pQ2JChhgJ9BzubVrui9cNPkkPDMmiqYGDHYiuaRM2F9/s1600/soal%2035.png",
          options: ["A. Termasuk senyawa alkena", "B. Dapat memiliki isomer cis-trans", "C. Merupakan isomer dari butana", "D. Dapat mengalami reaksi substitusi", "E. Ikatan rangkap terdapat pada atom karbon nomor 1 dan 2"],
          answer: [0, 1, 2], // Indices for checkboxes
          type: "multiple",
          explanation: `Jawaban Benar: A, B, C.<br><br>
          <strong>Analisis Senyawa (2-Butena):</strong><br>
          A. <strong>Benar.</strong> Memiliki ikatan rangkap dua (C=C), jadi Alkena.<br>
          B. <strong>Benar.</strong> Karbon pada ikatan rangkap mengikat dua gugus berbeda (H dan CH‚ÇÉ), sehingga bisa membentuk posisi Cis (sepihak) atau Trans (berseberangan).<br>
          C. <strong>Benar.</strong> Rumus molekulnya C‚ÇÑH‚Çà. Ini adalah isomer dari Siklobutana (C‚ÇÑH‚Çà) atau 1-Butena. (Dalam konteks soal umum, sering dianggap isomer gugus fungsi/posisi dari keluarga C4).<br>
          D. Salah. Alkena cenderung mengalami Adisi, bukan substitusi.<br>
          E. Salah. Ikatan rangkap ada di nomor 2 (antara C2 dan C3).`
        },
        {
          topic: "Identifikasi Hidrokarbon Tak Jenuh",
          question: "Diketahui beberapa senyawa hidrokarbon berdasarkan strukturnya. Pilihlah yang tergolong hidrokarbon tidak jenuh!",
          options: ["CH‚ÇÉ‚ÄìCH‚ÇÇ‚ÄìCH‚ÇÉ", "CH‚ÇÇ=CH‚ÄìCH‚ÇÉ", "CH‚â°C‚ÄìCH‚ÇÇ‚ÄìCH‚ÇÉ", "CH‚ÇÑ", "CH‚ÇÉ‚ÄìCH(CH‚ÇÉ)‚ÄìCH‚ÇÉ"],
          answer: [1, 2], // Indices for checkboxes
          type: "multiple",
          explanation: `Jawaban Benar: Opsi 2 dan 3.<br><br>
          <strong>Definisi Hidrokarbon Tak Jenuh:</strong><br>
          Senyawa yang memiliki setidaknya satu ikatan rangkap dua (=) atau rangkap tiga (‚â°) antar atom karbonnya. Disebut "tak jenuh" karena masih bisa ditambah atom hidrogen (belum maksimal).<br><br>
          <strong>Cek Struktur:</strong><br>
          1. CH‚ÇÉ‚ÄìCH‚ÇÇ‚ÄìCH‚ÇÉ (Propana): Ikatan tunggal semua ‚Üí Jenuh.<br>
          2. <strong>CH‚ÇÇ=CH‚ÄìCH‚ÇÉ (Propena):</strong> Ada rangkap dua ‚Üí <strong>Tak Jenuh</strong>.<br>
          3. <strong>CH‚â°C‚ÄìCH‚ÇÇ‚ÄìCH‚ÇÉ (1-Butuna):</strong> Ada rangkap tiga ‚Üí <strong>Tak Jenuh</strong>.<br>
          4. CH‚ÇÑ (Metana): Tunggal ‚Üí Jenuh.<br>
          5. Isobutana: Tunggal ‚Üí Jenuh.`
        },
        {
          topic: "Isomer Posisi",
          question: "Salah satu isomer posisi dari 2-pentena adalah...",
          options: ["A. 1-pentena", "B. 3-etil-2-butena", "C. 2-metil-1-butena", "D. 2-metil-2-butena", "E. 3-etil-1-butena"],
          answer: 0,
          type: "single",
          explanation: `Jawaban yang tepat adalah A (1-pentena).<br><br>
          <strong>Konsep Isomer Posisi:</strong><br>
          Terjadi ketika kerangka karbon utamanya TETAP, tetapi letak gugus fungsinya (ikatan rangkap) BERGESER.<br><br>
          <strong>Analisis:</strong><br>
          Senyawa awal: <strong>2-pentena</strong> (Rantai lurus 5 karbon, rangkap di nomor 2).<br>
          Pilihan A: <strong>1-pentena</strong> (Rantai lurus 5 karbon, rangkap di nomor 1).<br>
          Hanya posisi rangkap yang pindah dari 2 ke 1. Ini definisi murni isomer posisi. Pilihan lain melibatkan perubahan kerangka (isomer kerangka).`
        }
      ],
      hard: [
        { 
          topic: "Dampak Pembakaran", 
          question: "Pembakaran bensin tak sempurna di mesin tua menghasilkan gas CO. Mengapa gas ini disebut silent killer dibandingkan CO‚ÇÇ?", 
          options: [
            "A. Karena CO merusak paru-paru secara korosif.", 
            "B. Karena CO berikatan dengan hemoglobin 200x lebih kuat daripada Oksigen sehingga menghambat transportasi oksigen.", 
            "C. Karena CO memicu kanker darah seketika.", 
            "D. Karena CO menyebabkan suhu tubuh naik drastis.", 
            "E. Karena CO melubangi jantung."
          ], 
          answer: 1, 
          type: "single",
          explanation: `Jawaban yang tepat adalah B.<br><br>
          <strong>Mekanisme Pembunuh Senyap (Silent Killer):</strong><br>
          Di dalam darah, Oksigen diangkut oleh Hemoglobin (Hb). Gas Karbon Monoksida (CO) memiliki sifat jahat: ia punya daya tarik (afinitas) terhadap Hemoglobin <strong>200-250 kali lebih kuat</strong> dibandingkan Oksigen.<br><br>
          Akibatnya, jika ada sedikit saja gas CO, Hemoglobin akan lebih memilih mengikat CO membentuk HbCO (Karboksihemoglobin) daripada mengikat Oksigen. Tubuh akan mengalami hipoksia (kekurangan oksigen) secara diam-diam, menyebabkan pingsan dan kematian tanpa rasa sakit.` 
        },
        { 
          topic: "Kimia Pangan", 
          question: "Pasar Induk Kramat Jati menerima pasokan pisang dalam jumlah tonase besar setiap hari. Agar pisang matang serentak, pedagang sering menggunakan karbit (CaC‚ÇÇ). Meskipun efektif, karbit teknis sering mengandung residu arsenik dan fosfor yang berbahaya, serta menghasilkan gas asetilena yang mudah meledak. Sebagai ahli kimia pangan, alternatif metode pematangan yang lebih aman dan alami karena menggunakan hormon tumbuhan yang sama adalah...", 
          options: [
            "A. Menyuntikkan sirup gula ke dalam batang pisang.", 
            "B. Menggunakan gas Etilen (C‚ÇÇH‚ÇÑ) murni atau meletakkan apel matang di dekat pisang, karena etilen adalah hormon pematangan alami.", 
            "C. Menjemur pisang di bawah terik matahari langsung agar panasnya memecah pati.", 
            "D. Merendam pisang dalam larutan alkohol untuk memicu fermentasi.", 
            "E. Membungkus pisang dengan plastik hitam rapat tanpa ventilasi agar gas CO‚ÇÇ menumpuk."
          ], 
          answer: 1, 
          type: "single",
          explanation: `Jawaban yang tepat adalah B.<br><br>
          <strong>Penjelasan Ilmiah:</strong><br>
          Secara alami, tumbuhan menghasilkan hormon pematangan sendiri yang berwujud gas, yaitu <strong>Gas Etilen (Etena, C‚ÇÇH‚ÇÑ)</strong>.<br>
          Buah klimaterik seperti Apel yang sudah matang melepaskan gas etilen dalam jumlah banyak ke udara. Dengan meletakkan apel matang di dekat pisang mentah dalam wadah tertutup, etilen dari apel akan "menular" dan memicu reaksi pematangan enzimatis pada pisang secara alami dan aman, tanpa residu kimia berbahaya.` 
        },
        { 
          topic: "Bensin & Oktan", 
          question: "Mesin kendaraan yang mengalami 'knocking' (ketukan) biasanya disebabkan oleh penggunaan bensin dengan nilai oktan rendah. Apa yang terjadi secara kimiawi di dalam mesin?", 
          options: [
            "A. Bensin tidak mau terbakar sama sekali.", 
            "B. Busi memercikkan api terlalu kuat.", 
            "C. Bensin bercampur dengan oli mesin.", 
            "D. Bensin terbakar spontan (pre-ignition) akibat tekanan sebelum busi memercikkan api.", 
            "E. Bensin menciptakan pembakaran yang tidak spontan"
          ], 
          answer: 3, 
          type: "single",
          explanation: `Jawaban yang tepat adalah D.<br><br>
          <strong>Fenomena Knocking (Ketukan):</strong><br>
          Idealnya, bensin terbakar saat dipercikkan api oleh busi. Namun, bensin dengan <strong>Nilai Oktan Rendah</strong> (banyak mengandung rantai lurus seperti n-heptana) tidak tahan terhadap tekanan.<br><br>
          Saat piston menekan campuran bensin-udara, tekanan dan suhu naik. Bensin oktan rendah akan terbakar sendiri (meledak) secara prematur akibat tekanan tersebut <strong>sebelum</strong> busi menyala. Ledakan liar ini menabrak piston yang sedang bergerak naik, menimbulkan bunyi "tek-tek" (ngelitik) yang merusak mesin.` 
        },
        { 
          topic: "Tata Nama Alkana", 
          question: "Sebuah senyawa memiliki nama IUPAC: 3-etil-2,2,4,5-tetrametilheksana. Namun, nama ini dianggap SALAH karena melanggar aturan rantai terpanjang. Nama yang BENAR untuk struktur tersebut seharusnya adalah...", 
          options: [
            "A. 3,4,5,5-tetrametil-4-etilheksana", 
            "B. 4-etil-3,3,4,5-tetrametilheptana", 
            "C. 3,3,4,5-tetrametil-4-isopropilheptana", 
            "D. 4-ters-butil-2,3-dimetilheksana", 
            "E. 3,3,5,5-tetrametil-4-etilheksana"
          ], 
          answer: 1, 
          type: "single",
          explanation: `Gambar dulu struktur 3-etil-2,2,4,5-tetrametilheksana, baru setelah itu analisis kesalahan namanya.<br><br>
          Jawaban yang tepat adalah B (4-etil-3,3,4,5-tetrametilheptana).<br><br>
          <strong>Analisis Kesalahan Nama Lama:</strong><br>
          Nama lama menggunakan induk "Heksana" (6 karbon). Gugus etil di posisi 3 sebenarnya bisa memperpanjang rantai.<br>
          Jika kita gambar strukturnya dan cari ulang jalan terpanjang, ternyata jalur yang belok ke gugus etil menghasilkan rantai <strong>7 Karbon (Heptana)</strong>.<br><br>
          Dengan induk baru Heptana, kita nomori ulang agar cabang-cabang mendapat nomor sekecil mungkin. Hasil analisis struktur yang benar menghasilkan nama: <strong>4-etil-3,3,4,5-tetrametilheptana</strong>.` 
        },
        { 
          topic: "Sifat Fisik Hidrokarbon", 
          question: "Tumpahan minyak bumi di laut sulit dibersihkan dan menutupi permukaan air, menghalangi sinar matahari dan oksigen bagi biota laut. Sifat hidrokarbon apa yang menyebabkan masalah ini?", 
          options: [
            "A. Hidrofilik dan massa jenis lebih besar dari air.", 
            "B. Hidrofobik dan massa jenis lebih kecil dari air.", 
            "C. Mudah menguap.", 
            "D. Bersifat asam kuat.", 
            "E. Bersifat basa kuat"
          ], 
          answer: 1, 
          type: "single",
          explanation: `Jawaban yang tepat adalah B.<br><br>
          <strong>Dua Sifat Kunci Minyak Bumi:</strong><br>
          1. <strong>Hidrofobik (Non-Polar):</strong> Minyak adalah hidrokarbon non-polar, sedangkan air adalah polar. Sesuai prinsip <em>"like dissolves like"</em>, keduanya tidak bisa bercampur (minyak menolak air).<br>
          2. <strong>Massa Jenis (Densitas):</strong> Massa jenis minyak bumi (< 1 g/cm¬≥) lebih ringan daripada air laut (> 1 g/cm¬≥).<br><br>
          Kombinasi sifat "tidak larut air" dan "lebih ringan dari air" inilah yang menyebabkan minyak selalu <strong>mengapung</strong> di permukaan laut dan sulit tenggelam/larut.` 
        },
        { 
          topic: "Reaksi Adisi", 
          question: "Nama reaksi dan produk yang dihasilkan dari reaksi di bawah ini adalah ...<div class='w-full text-center py-4 text-cyan-300 text-xl font-mono font-bold tracking-widest'>CH‚ÇÇ = CH ‚Äì CH‚ÇÇ ‚Äì CH‚ÇÉ + HBr ‚Üí X</div>", 
          options: [
            "A. Substitusi, 2-bromobutana", 
            "B. Substitusi, 1-bromobutana", 
            "C. Adisi, 2-bromobutana", 
            "D. Adisi, 1-bromobutana", 
            "E. Eliminasi, 1-bromobutana"
          ], 
          answer: 2, 
          type: "single",
          explanation: `Jawaban yang tepat adalah C (Adisi, 2-bromobutana).<br><br>
          <strong>Analisis Reaksi (Aturan Markovnikov):</strong><br>
          Reaksi antara Alkena dengan Asam Halida (HBr) adalah reaksi <strong>Adisi</strong> (pemutusan rangkap).<br>
          <strong>Aturan Markovnikov:</strong> "Atom H dari HBr akan masuk ke atom C rangkap yang punya lebih banyak H (Yang kaya H makin kaya)".<br>
          - C1 (CH‚ÇÇ) punya 2 H.<br>
          - C2 (CH) punya 1 H.<br>
          Maka, H masuk ke C1 (jadi CH‚ÇÉ), dan Br terpaksa masuk ke C2.<br>
          Hasilnya: CH‚ÇÉ‚ÄìCH(Br)‚ÄìCH‚ÇÇ‚ÄìCH‚ÇÉ, yaitu <strong>2-bromobutana</strong>.` 
        },
        { 
          topic: "Tata Nama Siklik", 
          question: "Bagaimana penamaan senyawa sikloalkana jika cincinnya mengikat rantai alkana yang JAUH lebih panjang daripada ukuran cincinnya?\n(Contoh: Cincin propana segitiga mengikat rantai lurus 10 karbon dekana).", 
          options: [
            "A. Namanya menjadi Propildekana.", 
            "B. Tetap dinamai sebagai turunan benzena.", 
            "C. Rantai lurus jadi induk: 1-siklopropildekana.", 
            "D. Cincin selalu jadi induk: 1-dekilsiklopropana.", 
            "E. Tidak bisa diberi nama"
          ], 
          answer: 2, 
          type: "single",
          explanation: `Jawaban yang tepat adalah C (1-siklopropildekana).<br><br>
          <strong>Aturan Prioritas IUPAC:</strong><br>
          Kita harus membandingkan jumlah atom karbon pada cincin vs rantai lurus.<br>
          - Jika C Cincin ‚â• C Rantai, maka cincin jadi induk (Sikloalkana).<br>
          - Jika <strong>C Rantai > C Cincin</strong>, maka rantai lurus jadi induk (Alkana), dan cincin dianggap sebagai cabang (Sikloalkil).<br><br>
          Karena Dekana (10 C) > Siklopropana (3 C), maka induknya adalah Dekana. Namanya: <strong>1-siklopropildekana</strong>.` 
        },
        { 
          topic: "Hidrokarbon Aromatik", 
          question: "Saat pesta BBQ, Anda melihat teman membakar daging sampai gosong hitam (arang) karena rasanya lebih smokey. Anda tahu bahwa pembakaran lemak tak sempurna menghasilkan senyawa Hidrokarbon Aromatik Polisiklik (PAH) seperti Benzopirena. Tindakan preventif apa yang Anda sarankan?", 
          options: [
            "A. Buang bagian hitamnya. Struktur cincin aromatik datar pada PAH dapat menyusup (interkalasi) ke dalam DNA sel kita, memicu mutasi genetik (kanker).", 
            "B. Bakar lebih lama lagi sampai jadi abu putih biar racunnya hilang.", 
            "C. Minum air jeruk nipis setelah makan, asamnya akan menguraikan cincin benzena.", 
            "D. Makan bagian gosongnya saja, karena lemaknya sudah habis.", 
            "E. Makan saja, arang itu karbon aktif yang menyerap racun."
          ], 
          answer: 0, 
          type: "single",
          explanation: `Jawaban yang tepat adalah A.<br><br>
          <strong>Bahaya Kimia BBQ:</strong><br>
          Bagian hitam/gosong pada daging mengandung senyawa <strong>PAH (Polycyclic Aromatic Hydrocarbons)</strong> seperti Benzopirena.<br>
          <strong>Mekanisme Kanker:</strong><br>
          Molekul PAH berbentuk datar (geometri planar). Bentuk ini memungkinkannya menyusup masuk di sela-sela tangga DNA sel manusia (Interkalasi). Hal ini mengganggu proses replikasi DNA saat sel membelah, menyebabkan kesalahan kode genetik (mutasi) yang memicu kanker. Membuang bagian gosong adalah cara fisik paling efektif menghindari racun ini.` 
        },
        { 
          topic: "Kimia Hijau & Polimer", 
          question: "Perusahaan mi instan terbesar di Indonesia memproduksi jutaan bungkus mi setiap harinya. Sebagian besar kemasan cup noodle menggunakan bahan Styrofoam (Polistirena) karena sifatnya yang ringan dan menahan panas. Namun, senyawa penyusunnya yaitu stirena (C‚ÇÜH‚ÇÖCH=CH‚ÇÇ) diketahui sulit terurai (non-biodegradable) dan berpotensi karsinogenik jika terkena suhu tinggi. Salah satu langkah inovasi kimia hijau yang paling tepat untuk menggantikan bahan tersebut tanpa menghilangkan fungsi kemasannya adalah...", 
          options: [
            "A. Melapisi styrofoam dengan lilin tebal agar stirena tidak bocor ke makanan.", 
            "B. Mengganti bahan dasar polimer stirena dengan bioplastik berbahan dasar pati singkong atau jagung (PLA) yang mudah terurai.", 
            "C. Membakar seluruh limbah kemasan styrofoam di insinerator suhu tinggi agar musnah menjadi abu.", 
            "D. Menggunakan kemasan kaca yang berat namun dapat dipakai berulang kali oleh konsumen.", 
            "E. Menambahkan zat pengawet ke dalam styrofoam agar lebih tahan lama di tempat pembuangan akhir."
          ], 
          answer: 1, 
          type: "single",
          explanation: `Jawaban yang tepat adalah B.<br><br>
          <strong>Prinsip Kimia Hijau (Green Chemistry):</strong><br>
          Salah satu pilar utamanya adalah menggunakan bahan baku terbarukan (<em>Renewable Feedstocks</em>) dan mendesain bahan kimia yang mudah terurai (<em>Design for Degradation</em>).<br><br>
          Styrofoam berasal dari minyak bumi (tak terbarukan) dan abadi di alam. Solusi terbaik adalah menggantinya dengan <strong>Bioplastik (seperti PLA - Asam Polilaktat)</strong> yang terbuat dari pati singkong/jagung. PLA bisa dibuat tahan panas seperti styrofoam, tetapi jika dibuang ke tanah, ia akan dimakan mikroba dan terurai menjadi kompos alami.` 
        },
        { 
          topic: "Kimia & Sosial (SSI)", 
          question: "Setelah mendapat banyak masukan, perusahaan tersebut akhirnya berencana mengganti seluruh kemasan Styrofoam-nya dengan Bioplastik yang terbuat dari pati singkong dan jagung (Polylactic Acid - PLA). Langkah ini dipuji karena bioplastik mudah terurai oleh mikroba tanah.\nNamun, kebijakan ini mendapatkan kritik keras dari para ahli ketahanan pangan. Mereka menilai bahwa jika bioplastik diproduksi secara massal untuk menggantikan plastik konvensional, akan muncul masalah nasional baru yang serius. Risiko dampak negatif utama yang dikhawatirkan terjadi adalah...", 
          options: [
            "A. Bioplastik akan membuat rasa mi instan menjadi sedikit manis dan berbau apek karena terbuat dari bahan dasar singkong.", 
            "B. Terjadinya kompetisi penggunaan lahan; stok singkong dan jagung yang seharusnya untuk sumber pangan rakyat akan habis tersedot untuk bahan baku pabrik plastik, memicu kelangkaan makanan.", 
            "C. Bioplastik akan mengundang hama tikus dan semut masuk ke dalam gudang penyimpanan pabrik karena mengandung rantai glukosa yang disukai hewan.", 
            "D. Proses penguraian bioplastik di dalam tanah akan menghasilkan gas Oksigen berlebih yang dapat memicu kebakaran lahan gambut secara spontan.", 
            "E. Petani singkong akan menolak menanam singkong karena proses pembuatan bioplastik jauh lebih rumit daripada menjual singkong goreng."
          ], 
          answer: 1, 
          type: "single",
          explanation: `Jawaban yang tepat adalah B.<br><br>
          <strong>Dilema SSI (Socio-Scientific Issues):</strong><br>
          Ini adalah konflik klasik <strong>"Food vs Fuel/Material"</strong>.<br>
          Meskipun bioplastik baik untuk lingkungan (mengurangi sampah), bahan bakunya adalah makanan pokok (Singkong/Jagung).<br>
          Jika industri plastik skala raksasa memborong singkong petani, maka stok singkong untuk makanan rakyat akan berkurang drastis. Hukum ekonomi berlaku: kelangkaan pangan akan menyebabkan harga makanan melonjak tinggi, yang bisa memicu krisis pangan dan kelaparan bagi rakyat miskin.` 
        }
      ]
    };

    // Helper: Shuffle Array
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // State Management
    let state = {
      currentLevel: null,
      currentQuestion: 0,
      currentHistoryIndex: 0,
      answers: {},
      scores: { easy: 0, medium: 0, hard: 0 },
      completed: { easy: false, medium: false, hard: false },
      answeredCount: { easy: 0, medium: 0, hard: 0 },
      correctAnswers: { easy: 0, medium: 0, hard: 0 },
      timer: 0,
      timerInterval: null,
      unlocked: { easy: true, medium: false, hard: false },
      currentHistoryLevel: 'easy',
      questionMapping: { easy: null, medium: null, hard: null }
    };

    // Load state
    function loadState() {
      const saved = localStorage.getItem('quizState');
      if (saved) {
        const savedState = JSON.parse(saved);
        state.scores = savedState.scores || state.scores;
        state.completed = savedState.completed || state.completed;
        state.unlocked = savedState.unlocked || state.unlocked;
        state.correctAnswers = savedState.correctAnswers || state.correctAnswers;
        state.answeredCount = savedState.answeredCount || state.answeredCount;
        state.answers = savedState.answers || state.answers;
        state.questionMapping = savedState.questionMapping || state.questionMapping;
      }
    }

    // Save state
    function saveState() {
      localStorage.setItem('quizState', JSON.stringify({
        scores: state.scores,
        completed: state.completed,
        unlocked: state.unlocked,
        correctAnswers: state.correctAnswers,
        answeredCount: state.answeredCount,
        answers: state.answers,
        questionMapping: state.questionMapping
      }));
    }

    // Check unlock status (Updated Thresholds for 10 questions)
    // Max Easy: 100, Max Medium: 150. Threshold > 51 pts is still valid (approx 50-60% correct).
    function checkUnlockStatus() {
      if (state.scores.easy >= 51) {
        state.unlocked.medium = true;
      }
      if (state.scores.medium >= 51) {
        state.unlocked.hard = true;
      }
      
      const mediumLock = document.getElementById('medium-lock');
      const hardLock = document.getElementById('hard-lock');
      
      if (state.unlocked.medium && mediumLock) {
        mediumLock.style.display = 'none';
      }
      if (state.unlocked.hard && hardLock) {
        hardLock.style.display = 'none';
      }
      saveState();
    }

    // Config Support for SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig: { main_title: "Zona Evaluasi", subtitle: "Hidrokarbon" },
        onConfigChange: async (newConfig) => {
          // Config logic here if needed
        }
      });
    }

    // --- LOGIC FUNCTIONS ---
    
    // Function to Show Instructions Modal
    function showInstructions() {
      playSound('click');
      const overlay = document.createElement('div');
      overlay.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4';
      overlay.innerHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 max-w-2xl w-[95%] md:w-full mx-auto border-t-4 border-t-purple-500 bounce-in overflow-auto max-h-[90vh]">
          <div class="flex items-center justify-between mb-4 md:mb-6 border-b border-white/10 pb-4">
              <div class="flex items-center gap-2 md:gap-3">
                <div class="text-3xl md:text-4xl">üìú</div>
                <h3 class="text-lg md:text-2xl font-bold text-white font-display uppercase tracking-widest text-glow-purple">PETUNJUK MISI</h3>
              </div>
              <button onclick="playSound('click'); this.parentElement.parentElement.parentElement.remove()" class="text-slate-400 hover:text-white transition-colors">
                <svg class="w-6 h-6 md:w-8 md:h-8" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
              </button>
          </div>
          
          <div class="space-y-4 md:space-y-6 text-slate-300 font-sans leading-relaxed text-sm md:text-base">
            
            <!-- Section 1: Timer -->
            <div class="bg-black/30 p-3 md:p-4 rounded-lg border border-purple-500/20">
              <h4 class="text-purple-400 font-bold uppercase tracking-wider mb-2 flex items-center gap-2">
                <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                Waktu Pengerjaan
              </h4>
              <ul class="list-disc list-inside text-xs md:text-sm space-y-1 ml-2">
                <li>Level <span class="text-green-400 font-bold">Mudah</span>: 15 Menit.</li>
                <li>Level <span class="text-amber-400 font-bold">Sedang</span>: 20 Menit.</li>
                <li>Level <span class="text-purple-400 font-bold">Sulit</span>: 25 Menit.</li>
                <li>Jika waktu habis, jawaban akan terkirim otomatis.</li>
              </ul>
            </div>

            <!-- Section 2: Soal & Nilai -->
            <div class="bg-black/30 p-3 md:p-4 rounded-lg border border-cyan-500/20">
              <h4 class="text-cyan-400 font-bold uppercase tracking-wider mb-2 flex items-center gap-2">
                <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                Struktur Penilaian
              </h4>
              <ul class="list-disc list-inside text-xs md:text-sm space-y-1 ml-2">
                <li>Setiap level terdiri dari <span class="text-white font-bold">10 Soal</span>.</li>
                <li>Bobot nilai: <span class="text-white font-bold">10 Poin / Soal</span> (Total Max: 100).</li>
                <li>Syarat Buka Kunci Level Berikutnya: Skor > <span class="text-white font-bold">51</span>.</li>
              </ul>
            </div>

            <!-- Section 3: Mekanisme -->
            <div class="bg-black/30 p-3 md:p-4 rounded-lg border border-amber-500/20">
              <h4 class="text-amber-400 font-bold uppercase tracking-wider mb-2 flex items-center gap-2">
                <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                Mekanisme Sistem
              </h4>
              <ul class="list-disc list-inside text-xs md:text-sm space-y-1 ml-2">
                <li><span class="text-white font-bold">Pilihan Ganda Kompleks:</span> Beberapa soal mungkin memiliki lebih dari satu jawaban benar (Kotak Centang).</li>
                <li><span class="text-white font-bold">Acak Soal (Shuffle):</span> Urutan soal akan diacak otomatis jika Anda mengulang level yang sudah selesai.</li>
                <li><span class="text-white font-bold">High Score:</span> Sistem hanya menyimpan nilai tertinggi yang pernah Anda raih.</li>
              </ul>
            </div>
            
          </div>

          <div class="mt-6 md:mt-8">
            <button onclick="playSound('click'); this.parentElement.parentElement.parentElement.remove()" class="w-full btn-cyber text-purple-300 font-bold py-3 px-6 rounded-lg transition-all uppercase tracking-widest text-sm md:text-base">
              SIAP MELAKSANAKAN MISI
            </button>
          </div>
        </div>
      `;
      document.body.appendChild(overlay);
    }

    function selectLevel(level) {
      if (!state.unlocked[level]) {
        playSound('warning');
        showLockedMessage(level);
        return;
      }
      if (state.completed[level]) {
        showRetryConfirmation(level);
        return;
      }
      playSound('click');
      startQuiz(level);
    }

    function startQuiz(level) {
      state.currentLevel = level;
      state.currentQuestion = 0;
      state.answers[level] = {};
      
      // Update styling for tabs
      ['easy', 'medium', 'hard'].forEach(l => {
          const tab = document.getElementById(`tab-${l}`);
          if(tab) {
              tab.classList.remove('border-cyan-500', 'text-cyan-400', 'bg-cyan-900/20');
              tab.classList.add('border-slate-700', 'text-slate-400');
          }
      });
      const activeTab = document.getElementById(`tab-${level}`);
      if(activeTab) {
          activeTab.classList.remove('border-slate-700', 'text-slate-400');
          activeTab.classList.add('border-cyan-500', 'text-cyan-400', 'bg-cyan-900/20');
      }
      
      document.getElementById('welcome-screen').classList.add('hidden');
      document.getElementById('history-screen').classList.add('hidden');
      document.getElementById('quiz-screen').classList.remove('hidden');
      
      const levelInfo = {
        easy: { emoji: 'üå±', title: 'LEVEL MUDAH', desc: 'MODE: KONSEP DASAR' },
        medium: { emoji: 'üî•', title: 'LEVEL SEDANG', desc: 'MODE: STRUKTUR & REAKSI' },
        hard: { emoji: 'üíé', title: 'LEVEL SULIT', desc: 'MODE: ANALISIS HOTS' }
      };
      
      document.getElementById('level-emoji').textContent = levelInfo[level].emoji;
      document.getElementById('level-title').textContent = levelInfo[level].title;
      document.getElementById('level-desc').textContent = levelInfo[level].desc;

      // SHUFFLE LOGIC:
      // Init array [0,1,2,...9]
      let indices = Array.from({length: 10}, (_, i) => i);
      
      // If completed before, shuffle indices
      if (state.completed[level]) {
         indices = shuffleArray(indices);
      }
      
      // Save mapping
      state.questionMapping[level] = indices;
      
      startTimer();
      generateQuestionPills();
      loadQuestion();
    }

    function showRetryConfirmation(level) {
       playSound('warning');
       const score = state.scores[level];
       const overlay = document.createElement('div');
       overlay.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4';
       overlay.innerHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 max-w-md w-full border-t-4 border-t-cyan-500 bounce-in">
          <div class="text-5xl md:text-6xl mb-4 text-center animate-pulse">üîÑ</div>
          <h3 class="text-xl md:text-2xl font-bold text-white mb-2 text-center font-display uppercase tracking-widest">REBOOT LEVEL?</h3>
          <p class="text-cyan-400/80 text-center mb-6 font-mono text-xs md:text-sm">RIWAYAT SKOR TERTINGGI: <span class="text-white text-xl font-bold">${score}</span></p>
          <div class="flex gap-4">
            <button onclick="playSound('click'); this.parentElement.parentElement.parentElement.remove()" class="flex-1 border border-slate-600 text-slate-400 hover:text-white hover:border-white font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
              BATAL
            </button>
            <button onclick="playSound('click'); this.parentElement.parentElement.parentElement.remove(); startQuiz('${level}');" class="flex-1 btn-cyber text-cyan-300 font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
              ULANGI
            </button>
          </div>
        </div>
      `;
      document.body.appendChild(overlay);
    }

    function handleHomeClick() {
      if (!document.getElementById('quiz-screen').classList.contains('hidden')) {
        confirmExit();
      } else {
        backToHome();
      }
    }

    function startTimer() {
      if (state.timerInterval) clearInterval(state.timerInterval);
      
      // Set durasi: Hard=25, Medium=20, Easy=15
      let durationMinutes = 20; // Default Medium
      if (state.currentLevel === 'hard') durationMinutes = 25;
      else if (state.currentLevel === 'easy') durationMinutes = 15;

      state.timer = durationMinutes * 60; 
      updateTimerDisplay();
      state.timerInterval = setInterval(() => {
        state.timer--;
        if (state.timer <= 0) {
          clearInterval(state.timerInterval);
          state.timer = 0;
          updateTimerDisplay();
          submitQuiz(); 
        } else {
          updateTimerDisplay();
        }
      }, 1000);
    }

    function updateTimerDisplay() {
      const minutes = Math.floor(state.timer / 60).toString().padStart(2, '0');
      const seconds = (state.timer % 60).toString().padStart(2, '0');
      const timerEl = document.getElementById('timer-display');
      if (timerEl) {
          timerEl.textContent = `${minutes}:${seconds}`;
          if (state.timer < 60) {
            timerEl.classList.remove('text-cyan-400', 'border-cyan-500/30');
            timerEl.classList.add('text-red-500', 'border-red-500/50', 'animate-pulse');
          } else {
            timerEl.classList.add('text-cyan-400', 'border-cyan-500/30');
            timerEl.classList.remove('text-red-500', 'border-red-500/50', 'animate-pulse');
          }
      }
    }

    function generateQuestionPills() {
      const container = document.getElementById('question-pills');
      container.innerHTML = '';
      for (let i = 0; i < 10; i++) { // Updated to 10
        const pill = document.createElement('button');
        const isAnswered = state.answers[state.currentLevel] && state.answers[state.currentLevel][i] !== undefined;
        // Check array length for multiple
        if (Array.isArray(state.answers[state.currentLevel][i]) && state.answers[state.currentLevel][i].length === 0) {
           // Treat empty array as unanswered for visual purposes if we want strictness, 
           // but technically user visited it. Let's keep simple existence check.
        }

        const isCurrent = i === state.currentQuestion;
        
        let pillClass = `w-full aspect-square rounded-sm font-bold text-xs md:text-sm transition-all duration-300 font-mono border flex items-center justify-center `;
        
        if (isCurrent) {
            pillClass += `border-purple-500 text-white bg-purple-500/20 shadow-[0_0_10px_#a855f7] scale-110 z-10`;
        } else if (isAnswered) {
            pillClass += `border-cyan-500 bg-cyan-500/20 text-cyan-300 shadow-[0_0_5px_#06b6d4]`;
        } else {
            pillClass += `border-slate-700 bg-slate-800 text-slate-500 hover:border-slate-500 hover:text-slate-300`;
        }
        
        pill.className = pillClass;
        pill.textContent = (i + 1).toString().padStart(2, '0');
        pill.onclick = () => { playSound('click'); goToQuestion(i); };
        container.appendChild(pill);
      }
    }

    function loadQuestion() {
      // Use mapping to get actual question index
      const mapping = state.questionMapping[state.currentLevel] || Array.from({length: 10}, (_, i) => i);
      const actualIndex = mapping[state.currentQuestion];

      const q = questions[state.currentLevel][actualIndex];
      const isMultiple = q.type === 'multiple';
      
      document.getElementById('topic-badge').textContent = `MODULE: ${q.topic}`;
      
      // Menggunakan innerHTML agar bisa merender tag HTML (div, panah, dll)
      const questionEl = document.getElementById('question-text');
      questionEl.innerHTML = q.question;
      
      // Menambahkan class 'text-justify' khusus untuk Level Hard (Sulit)
      if (state.currentLevel === 'hard') {
          questionEl.classList.add('text-justify');
      } else {
          questionEl.classList.remove('text-justify');
      }
      
      // Image Handling
      const imgContainer = document.getElementById('image-container');
      if (q.image) {
          // Mengubah ukuran gambar menjadi lebih kecil (max-w-sm dan max-h-60) agar tidak terlalu besar
          imgContainer.innerHTML = `<img src="${q.image}" class="max-w-full h-auto max-h-60 md:max-h-96 w-auto rounded-lg border border-cyan-500/30 shadow-[0_0_15px_rgba(0,243,255,0.1)] mx-auto object-contain" alt="Soal Image">`;
          imgContainer.classList.remove('hidden');
      } else {
          imgContainer.innerHTML = '';
          imgContainer.classList.add('hidden');
      }
      
      // UPDATED: Progress Bar starts at 0% (index 0 / 10 = 0%) and increases by 10% per question
      const progressPercent = (state.currentQuestion / 10) * 100; 
      const progressBar = document.getElementById('quiz-progress-bar');
      if(progressBar) progressBar.style.width = `${progressPercent}%`;

      const optionsContainer = document.getElementById('options-container');
      optionsContainer.innerHTML = '';
      
      // Get current answer (could be int or array)
      const currentAnswer = state.answers[state.currentLevel] && state.answers[state.currentLevel][state.currentQuestion];
      
      // Instruction for multiple
      if (isMultiple) {
          const hint = document.createElement('div');
          hint.className = "text-[10px] md:text-xs text-cyan-400 mb-2 font-mono tracking-wider animate-pulse";
          hint.textContent = "[SYSTEM]: CHECKLIST MODE ENABLED. SELECT MULTIPLE OPTIONS.";
          optionsContainer.appendChild(hint);
      }

      q.options.forEach((option, index) => {
        const btn = document.createElement('button');
        
        let isSelected = false;
        if (isMultiple) {
            isSelected = Array.isArray(currentAnswer) && currentAnswer.includes(index);
        } else {
            isSelected = currentAnswer === index;
        }
        
        // Futuristic styling for options
        let btnClass = `w-full p-3 md:p-4 rounded-lg text-left font-medium transition-all duration-300 relative border group overflow-hidden flex items-center `;
        
        if (isSelected) {
            btnClass += `bg-cyan-500/10 border-cyan-400 text-white shadow-[0_0_15px_rgba(0,243,255,0.15)]`;
        } else {
            btnClass += `bg-white/5 border-white/10 text-slate-300 hover:bg-white/10 hover:border-cyan-500/50 hover:text-white`;
        }
        
        btn.className = btnClass;
        
        // Add highlight bar
        const highlight = isSelected ? `<div class="absolute left-0 top-0 bottom-0 w-1 bg-cyan-400 shadow-[0_0_10px_#00f3ff]"></div>` : '';
        
        // Checkbox/Radio UI
        let checkUI = '';
        if (isMultiple) {
            checkUI = `<div class="cyber-checkbox ${isSelected ? 'checked' : ''}"></div>`;
        } else {
            checkUI = `<div class="w-4 h-4 md:w-5 md:h-5 rounded-full border-2 border-slate-500 mr-3 flex items-center justify-center ${isSelected ? 'border-cyan-400 bg-cyan-500/20' : ''}">
                ${isSelected ? '<div class="w-2 h-2 md:w-2.5 md:h-2.5 rounded-full bg-cyan-400 shadow-[0_0_5px_#00f3ff]"></div>' : ''}
            </div>`;
        }

        // CONDITIONAL RENDERING FOR ALPHABET LABEL
        // Hide alphabet if checklist (isMultiple), show if single choice
        const alphabetLabel = isMultiple ? '' : `<span class="font-mono text-xs md:text-sm opacity-50 border border-white/20 px-2 py-1 rounded ml-2">${String.fromCharCode(65 + index)}</span>`;

        btn.innerHTML = `
            ${highlight}
            ${checkUI}
            <div class="relative z-10 flex-1">
                <span class="text-sm md:text-lg tracking-wide">${option.replace(/^[A-F]\.\s*/, '')}</span> 
            </div>
            ${alphabetLabel}
        `;
        btn.onclick = () => selectAnswer(index, isMultiple);
        optionsContainer.appendChild(btn);
      });
      
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const submitBtn = document.getElementById('submit-btn');

      prevBtn.disabled = state.currentQuestion === 0;
      
      // Logika Tampilan Tombol Kirim/Selanjutnya
      if (state.currentQuestion === 9) {
          // Jika Soal Terakhir (Index 9): Sembunyikan Next, Tampilkan Submit
          nextBtn.classList.add('hidden');
          submitBtn.classList.remove('hidden');
      } else {
          // Selain Soal Terakhir: Tampilkan Next, Sembunyikan Submit
          nextBtn.classList.remove('hidden');
          submitBtn.classList.add('hidden');
      }
      
      generateQuestionPills();
    }

    function selectAnswer(index, isMultiple) {
      playSound('click'); // Add sound effect
      if (!state.answers[state.currentLevel]) state.answers[state.currentLevel] = {};
      
      if (isMultiple) {
          let current = state.answers[state.currentLevel][state.currentQuestion] || [];
          if (!Array.isArray(current)) current = [];
          
          if (current.includes(index)) {
              current = current.filter(i => i !== index);
          } else {
              current.push(index);
          }
          // Sort for easier comparison later
          current.sort((a, b) => a - b);
          state.answers[state.currentLevel][state.currentQuestion] = current;
      } else {
          state.answers[state.currentLevel][state.currentQuestion] = index;
      }
      
      loadQuestion();
    }

    function prevQuestion() {
      if (state.currentQuestion > 0) {
        playSound('click');
        state.currentQuestion--;
        loadQuestion();
      }
    }

    function nextQuestion() {
      if (state.currentQuestion < 9) { // Updated to 9
        playSound('click');
        state.currentQuestion++;
        loadQuestion();
      }
    }

    function goToQuestion(index) {
      playSound('click');
      state.currentQuestion = index;
      loadQuestion();
    }

    function showLockedMessage(level) {
      playSound('warning'); // Sound Effect
      const messages = {
        medium: 'AKSES DITOLAK: SELESAIKAN LEVEL MUDAH DENGAN SKOR > 51.',
        hard: 'AKSES DITOLAK: SELESAIKAN LEVEL SEDANG DENGAN SKOR > 51.'
      };
      
      const overlay = document.createElement('div');
      overlay.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4';
      overlay.innerHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 max-w-md w-full border-t-4 border-t-red-500 bounce-in">
          <div class="text-5xl md:text-6xl mb-4 text-center text-red-500 animate-pulse">üîí</div>
          <h3 class="text-xl md:text-2xl font-bold text-white mb-4 text-center font-display uppercase tracking-widest">PROTOKOL TERKUNCI</h3>
          <p class="text-red-400/80 text-center mb-6 font-mono text-xs md:text-sm">${messages[level]}</p>
          <button onclick="playSound('click'); this.parentElement.parentElement.remove()" class="w-full btn-cyber text-cyan-300 font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
            MENGERTI
          </button>
        </div>
      `;
      document.body.appendChild(overlay);
    }

    function submitEarly() {
      playSound('warning'); // Sound Effect
      const answered = state.answers[state.currentLevel] ? Object.keys(state.answers[state.currentLevel]).length : 0;
      const unanswered = 10 - answered; // Updated to 10
      
      const overlay = document.createElement('div');
      overlay.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4';
      overlay.innerHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 max-w-md w-full border-t-4 border-t-amber-500 bounce-in">
          <div class="text-5xl md:text-6xl mb-4 text-center">üì§</div>
          <h3 class="text-xl md:text-2xl font-bold text-white mb-2 text-center font-display uppercase tracking-widest">KONFIRMASI UPLOAD</h3>
          <div class="flex justify-between text-xs md:text-sm font-mono mb-6 bg-black/40 p-4 rounded border border-white/10">
              <span class="text-green-400">DATA: ${answered}</span>
              <span class="text-red-400">NULL: ${unanswered}</span>
          </div>
          <p class="text-slate-400 text-center mb-6 text-xs md:text-sm">Apakah Anda yakin ingin mengirimkan data jawaban sekarang?</p>
          <div class="flex gap-4">
            <button onclick="playSound('click'); this.parentElement.parentElement.parentElement.remove()" class="flex-1 border border-slate-600 text-slate-400 hover:text-white hover:border-white font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
              BATAL
            </button>
            <button onclick="this.parentElement.parentElement.parentElement.remove(); submitQuiz();" class="flex-1 bg-amber-500/20 border border-amber-500/50 text-amber-400 hover:bg-amber-500/40 font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
              KIRIM
            </button>
          </div>
        </div>
      `;
      document.body.appendChild(overlay);
    }

    function submitQuiz() {
      clearInterval(state.timerInterval);
      const level = state.currentLevel;
      const answers = state.answers[level] || {};
      const pointsPerQuestion = { easy: 10, medium: 10, hard: 10 };
      
      // Use mapping to verify answers
      const mapping = state.questionMapping[level] || Array.from({length: 10}, (_, i) => i);

      let correct = 0;
      // Loop visual index 0-9
      for(let i=0; i<10; i++) {
         const actualIndex = mapping[i]; // actual question index
         const q = questions[level][actualIndex];
         const userAns = answers[i]; // Answer given at visual position i

         if (q.type === 'multiple') {
            // Check array equality
            if (Array.isArray(userAns) && Array.isArray(q.answer) && 
                JSON.stringify(userAns.sort()) === JSON.stringify(q.answer.sort())) {
                correct++;
            }
         } else {
            if (userAns === q.answer) correct++;
         }
      }
      
      const currentScore = correct * pointsPerQuestion[level];
      
      // HIGH SCORE LOGIC: Compare with previous score
      const previousScore = state.scores[level] || 0;
      if (currentScore > previousScore) {
          state.scores[level] = currentScore;
          // Optionally update correct count if score improved (though simplified here)
          state.correctAnswers[level] = correct;
      } else {
          // Keep previous score if new score is lower
          // But ensure completed status is true
      }
      
      state.completed[level] = true;
      // state.correctAnswers[level] = correct; // Don't overwrite if we want to keep High Score stats, but simplified logic usually keeps best run.
      // Let's ensure correctAnswers matches the High Score run if possible, or just track current.
      // For simplicity in this codebase, we update correctAnswers if we update score.
      
      checkUnlockStatus();
      saveState();
      
      showHistory(level);
      
      if ((correct/10) >= 0.8) {
        playSound('win'); // Menang / Bagus
        createConfetti();
      } else {
        playSound('success'); // Netral / Selesai
      }
    }

    function createConfetti() {
      const colors = ['#00f3ff', '#bc13fe', '#ff00ff'];
      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.top = '-10px';
        confetti.style.width = Math.random() * 10 + 5 + 'px';
        confetti.style.height = confetti.style.width;
        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.boxShadow = `0 0 10px ${confetti.style.background}`;
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        
        document.body.appendChild(confetti);
        const animation = confetti.animate([
          { transform: `translateY(0) rotate(0deg)`, opacity: 1 },
          { transform: `translateY(100vh) rotate(${Math.random() * 720}deg)`, opacity: 0 }
        ], {
          duration: Math.random() * 2000 + 2000,
          easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
        });
        animation.onfinish = () => confetti.remove();
      }
    }

    function showHistory(targetLevel = 'easy') {
      document.getElementById('welcome-screen').classList.add('hidden');
      document.getElementById('quiz-screen').classList.add('hidden');
      document.getElementById('history-screen').classList.remove('hidden');
      updateHistorySummary();
      showHistoryLevel(targetLevel);
      document.getElementById('app').scrollTo({ top: 0, behavior: 'smooth' });
    }

    function updateHistorySummary() {
      const levels = ['easy', 'medium', 'hard'];
      // Updated Max Scores: Easy=100, Medium=100, Hard=100 (10 pts * 10 questions)
      const maxScores = { easy: 100, medium: 100, hard: 100 };
      levels.forEach(level => {
        const scoreEl = document.getElementById(`history-${level}-score`);
        const statusEl = document.getElementById(`history-${level}-status`);
        
        if (!scoreEl || !statusEl) return;

        if (state.completed[level]) {
          scoreEl.textContent = `${state.scores[level]}/${maxScores[level]}`;
          scoreEl.className = "text-2xl md:text-3xl font-bold text-cyan-400 mb-1 font-mono text-glow-cyan";
          statusEl.textContent = "STATUS: SELESAI";
          statusEl.className = "text-green-400 text-[10px] md:text-xs font-mono";
        } else {
          scoreEl.textContent = "N/A";
          scoreEl.className = "text-2xl md:text-3xl font-bold text-slate-600 mb-1 font-mono";
          statusEl.textContent = "STATUS: PENDING";
          statusEl.className = "text-slate-500 text-[10px] md:text-xs font-mono";
        }
      });
    }

    function showHistoryLevel(level) {
      state.currentHistoryLevel = level;
      state.currentHistoryIndex = 0;
      
      ['easy', 'medium', 'hard'].forEach(l => {
        const tab = document.getElementById(`history-tab-${l}`);
        if (l === level) {
            tab.className = 'flex-1 py-2 md:py-3 px-2 md:px-4 rounded-lg font-bold transition-all duration-300 bg-cyan-900/30 border border-cyan-500 text-cyan-400 uppercase tracking-widest shadow-[0_0_15px_rgba(0,243,255,0.2)] text-xs md:text-sm';
        } else {
            tab.className = 'flex-1 py-2 md:py-3 px-2 md:px-4 rounded-lg font-bold transition-all duration-300 bg-black/40 border border-slate-700 text-slate-500 uppercase tracking-widest hover:text-slate-300 text-xs md:text-sm';
        }
      });
      renderHistoryContent(level);
    }

    function nextHistoryQuestion() {
        if (state.currentHistoryIndex < 9) { // Updated to 9
            playSound('click');
            state.currentHistoryIndex++;
            renderHistoryContent(state.currentHistoryLevel);
        }
    }

    function prevHistoryQuestion() {
        if (state.currentHistoryIndex > 0) {
            playSound('click');
            state.currentHistoryIndex--;
            renderHistoryContent(state.currentHistoryLevel);
        }
    }

    function renderHistoryContent(level) {
      const container = document.getElementById('history-content');
      
      if (!state.completed[level]) {
        container.innerHTML = `
          <div class="futuristic-card rounded-2xl p-8 md:p-12 text-center border-t-4 border-t-slate-600">
            <div class="text-5xl md:text-7xl mb-4 md:mb-6 opacity-50 grayscale">üìù</div>
            <h3 class="text-xl md:text-2xl font-bold text-white mb-3 font-display uppercase tracking-widest">DATA TIDAK DITEMUKAN</h3>
            <p class="text-slate-400 mb-6 md:mb-8 font-mono text-xs md:text-sm">Tidak ada catatan simulasi untuk level ini.</p>
            <button onclick="backToHome(); setTimeout(() => selectLevel('${level}'), 300)" class="btn-cyber text-cyan-300 font-bold py-3 px-6 md:px-8 rounded-lg inline-flex items-center gap-2 text-sm md:text-base">
              <span>üöÄ</span> MULAI SIMULASI
            </button>
          </div>
        `;
        return;
      }
      
      const index = state.currentHistoryIndex || 0;
      // Map back to actual question using stored mapping
      const mapping = state.questionMapping[level] || Array.from({length: 10}, (_, i) => i);
      const actualIndex = mapping[index];
      
      const q = questions[level][actualIndex];
      const answers = state.answers[level] || {};
      const userAnswer = answers[index];
      
      let isCorrect = false;
      const isMultiple = q.type === 'multiple';
      
      if (isMultiple) {
          if (Array.isArray(userAnswer) && Array.isArray(q.answer) && 
              JSON.stringify(userAnswer.sort()) === JSON.stringify(q.answer.sort())) {
              isCorrect = true;
          }
      } else {
          isCorrect = userAnswer === q.answer;
      }

      const isSkipped = userAnswer === undefined || (isMultiple && (!userAnswer || userAnswer.length === 0));
      
      let contentHTML = '';

      if (isSkipped) {
        // --- TAMPILAN TERKUNCI ---
        contentHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 border-l-4 border-l-slate-600 relative overflow-hidden">
          <div class="flex items-center justify-between mb-4 md:mb-6 border-b border-white/5 pb-4">
            <span class="text-slate-500 font-bold font-mono tracking-widest text-[10px] md:text-sm flex items-center gap-2">
                <span class="text-base md:text-lg">üîí</span> MODULE: ${q.topic}
            </span>
            <span class="text-2xl md:text-4xl grayscale opacity-30">‚è≠Ô∏è</span>
          </div>
          <p class="text-slate-500 font-semibold mb-6 md:mb-8 text-base md:text-xl font-display leading-relaxed blur-[2px] select-none">${q.question}</p>
          <div class="absolute inset-0 bg-black/60 backdrop-blur-sm flex flex-col items-center justify-center text-center p-6 z-20">
            <div class="text-4xl md:text-5xl mb-4 text-slate-400 animate-pulse">üîí</div>
            <h4 class="text-white font-bold mb-2 text-lg md:text-xl font-display uppercase tracking-widest">ENKRIPSI DIAKTIFKAN</h4>
            <p class="text-slate-400 mb-6 font-mono text-xs md:text-sm max-w-md">Data pembahasan terkunci karena soal ini dilewati saat simulasi.</p>
            <button onclick="playSound('click'); startQuiz('${level}')" class="bg-amber-500/20 border border-amber-500 text-amber-400 hover:bg-amber-500/40 font-bold py-3 px-6 md:px-8 rounded-lg transition-all flex items-center gap-2 text-sm md:text-base">
                <span>üîÑ</span> REBOOT LEVEL
            </button>
          </div>
        </div>
        `;
      } else {
        // --- TAMPILAN TERBUKA ---
        const statusColor = isCorrect ? 'green' : 'red';
        const borderColor = isCorrect ? 'border-l-green-500' : 'border-l-red-500';
        const shadowColor = isCorrect ? 'shadow-[0_0_20px_rgba(74,222,128,0.2)]' : 'shadow-[0_0_20px_rgba(248,113,113,0.2)]';
        
        contentHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 border-l-4 ${borderColor} ${shadowColor}">
          <div class="flex items-center justify-between mb-4 md:mb-6 border-b border-white/5 pb-4">
            <span class="text-cyan-300 font-bold font-mono tracking-widest text-[10px] md:text-sm uppercase">MODULE: ${q.topic}</span>
            <span class="text-2xl md:text-4xl drop-shadow-md">${isCorrect ? '‚úÖ' : '‚ùå'}</span>
          </div>

          ${q.image ? `<img src="${q.image}" class="max-w-full h-auto max-h-60 md:max-h-96 w-auto mx-auto rounded-lg mb-6 border border-white/10 object-contain" />` : ''}
          <p class="text-white font-semibold mb-6 md:mb-8 text-base md:text-xl font-display leading-relaxed tracking-wide">${q.question}</p>

          <div class="space-y-3 mb-6 md:mb-8">
            ${q.options.map((opt, i) => {
                let optClass = "p-3 md:p-4 rounded-lg border flex items-center transition-all ";
                let isUserSelected = false;
                let isRealAnswer = false;
                
                if (isMultiple) {
                    isUserSelected = userAnswer.includes(i);
                    isRealAnswer = q.answer.includes(i);
                } else {
                    isUserSelected = userAnswer === i;
                    isRealAnswer = q.answer === i;
                }

                if (isRealAnswer) {
                    optClass += "bg-green-500/10 border-green-500 text-green-300 shadow-[0_0_10px_rgba(74,222,128,0.2)]";
                } else if (isUserSelected && !isCorrect) {
                    optClass += "bg-red-500/10 border-red-500 text-red-300 shadow-[0_0_10px_rgba(248,113,113,0.2)]";
                } else {
                    optClass += "bg-black/20 border-white/5 text-slate-400";
                }
                
                // Checkbox/Radio Icon for History
                let checkIcon = '';
                if (isMultiple) {
                    checkIcon = `<div class="w-4 h-4 border border-current rounded mr-3 flex items-center justify-center">${isRealAnswer || isUserSelected ? '‚úì' : ''}</div>`;
                }

                // Hide alphabet label in history if multiple choice checklist
                const alphabetLabel = isMultiple ? '' : `<span class="font-mono text-xs md:text-sm mr-4 opacity-70 border border-white/10 px-2 py-1 rounded">${String.fromCharCode(65 + i)}</span>`;

                return `
                  <div class="${optClass}">
                    ${alphabetLabel}
                    ${checkIcon}
                    <span class="flex-1 text-sm md:text-base">${opt.replace(/^[A-F]\.\s*/, '')}</span>
                    ${isRealAnswer ? '<span class="text-[10px] md:text-xs font-bold uppercase tracking-wider ml-2 text-green-400 border border-green-500 px-2 py-0.5 rounded">BENAR</span>' : ''}
                    ${isUserSelected && !isCorrect ? '<span class="text-[10px] md:text-xs font-bold uppercase tracking-wider ml-2 text-red-400 border border-red-500 px-2 py-0.5 rounded">JAWABANMU</span>' : ''}
                  </div>
                `;
            }).join('')}
          </div>

          <div class="bg-blue-900/20 rounded-xl p-4 md:p-6 border border-blue-500/30">
            <h4 class="text-blue-300 font-bold mb-2 md:mb-3 flex items-center gap-2 text-xs md:text-sm uppercase tracking-widest">
                <span class="text-lg md:text-xl">üí°</span> Analisis Data
            </h4>
            <p class="text-blue-100/90 text-xs md:text-sm leading-relaxed font-sans">${q.explanation}</p>
          </div>
        </div>
        `;
      }

      container.innerHTML = `
        <div class="flex justify-between items-center mb-4 text-slate-400 font-mono text-[10px] md:text-sm">
            <span>INDEX DATA: <span class="text-cyan-400 font-bold">${(index + 1).toString().padStart(2, '0')}</span> / 10</span>
            <span class="${isSkipped ? 'text-slate-500' : (isCorrect ? 'text-green-400' : 'text-red-400')} font-bold uppercase tracking-wider border border-white/10 px-2 md:px-3 py-1 rounded">
                ${isSkipped ? 'üîí TERKUNCI' : (isCorrect ? 'STATUS: VALID' : 'STATUS: INVALID')}
            </span>
        </div>

        ${contentHTML}

        <div class="flex justify-between mt-6 md:mt-8 gap-4">
            <button onclick="prevHistoryQuestion()" ${index === 0 ? 'disabled' : ''} class="flex-1 border border-slate-700 text-slate-400 hover:text-white hover:border-cyan-500 hover:bg-cyan-500/10 font-bold py-3 md:py-4 px-4 md:px-6 rounded-lg disabled:opacity-30 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs md:text-base">
                ‚Üê <span class="hidden md:inline">SEBELUMNYA</span>
            </button>
            <button onclick="${index === 9 ? 'backToHome()' : 'nextHistoryQuestion()'}" class="flex-1 btn-cyber text-cyan-300 hover:text-white font-bold py-3 md:py-4 px-4 md:px-6 rounded-lg transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs md:text-base">
                ${index === 9 ? 'TUTUP AKSES' : '<span class="hidden md:inline">SELANJUTNYA</span> ‚Üí'}
            </button>
        </div>
      `;
    }

    function confirmExit() {
      playSound('warning'); // Sound Effect
      const overlay = document.createElement('div');
      overlay.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4';
      overlay.innerHTML = `
        <div class="futuristic-card rounded-2xl p-6 md:p-8 max-w-md w-full border-t-4 border-t-red-500 bounce-in">
          <div class="text-5xl md:text-6xl mb-4 text-center text-red-500 animate-pulse">‚ö†Ô∏è</div>
          <h3 class="text-xl md:text-2xl font-bold text-white mb-4 text-center font-display uppercase tracking-widest">PERINGATAN SISTEM</h3>
          <p class="text-slate-300 text-center mb-2 text-sm md:text-base">Progres saat ini belum tersimpan secara permanen.</p>
          <p class="text-slate-400 text-center mb-6 text-xs md:text-sm font-mono">Keluar sekarang akan menghapus data sesi ini.</p>
          <div class="flex gap-4">
            <button onclick="playSound('click'); this.parentElement.parentElement.parentElement.remove()" class="flex-1 border border-slate-600 text-slate-400 hover:text-white hover:border-white font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
              BATAL
            </button>
            <button onclick="exitToHome()" class="flex-1 bg-red-500/20 border border-red-500 text-red-400 hover:bg-red-500/40 font-bold py-3 px-6 rounded-lg transition-all text-sm md:text-base">
              KELUAR
            </button>
          </div>
        </div>
      `;
      document.body.appendChild(overlay);
    }

    function exitToHome() {
      playSound('click');
      const overlays = document.querySelectorAll('.fixed.inset-0');
      overlays.forEach(overlay => overlay.remove());
      
      // Clear timer
      if (state.timerInterval) {
        clearInterval(state.timerInterval);
      }
      
      // Reset current quiz state (but keep completed scores)
      if (state.currentLevel) {
        state.answers[state.currentLevel] = {};
      }
      state.currentQuestion = 0;
      
      // Go back to home
      backToHome();
    }

    function backToHome() {
      playSound('click');
      document.getElementById('welcome-screen').classList.remove('hidden');
      document.getElementById('quiz-screen').classList.add('hidden');
      document.getElementById('history-screen').classList.add('hidden');
      checkUnlockStatus();
    }

    // Initialize
    loadState();
    checkUnlockStatus();
  </script>
</body>
</html>